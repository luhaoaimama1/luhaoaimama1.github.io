<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="Android-BitmapComposer(类似于AE的合成模式)"/>




  <meta name="keywords" content="android,bitmap," />




  <link rel="alternate" href="/atom.xml" title="Zone">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.1.0" />



<link rel="canonical" href="https://luhaoaimama1.github.io/2017/01/19/Camera调研/"/>


<meta name="description" content="View,Camera 坐标轴分析


View
Camera
Camera Lib











同view


左手坐标系 判断依据
camera视角的图片锚点坐标系  解释1
同view




解释1：其实用的也是左手坐标系,但是为什么会围绕X旋转180呢？ 
回答：因为我们的API名字叫做Camera 他是以摄像机的角度去 理解做操作的； 可以自己拿手机拍照去 移动里面的物体。">
<meta property="og:type" content="article">
<meta property="og:title" content="Android-BitmapComposer(类似于AE的合成模式)">
<meta property="og:url" content="https://luhaoaimama1.github.io/2017/01/19/Camera调研/index.html">
<meta property="og:site_name" content="Zone">
<meta property="og:description" content="View,Camera 坐标轴分析


View
Camera
Camera Lib











同view


左手坐标系 判断依据
camera视角的图片锚点坐标系  解释1
同view




解释1：其实用的也是左手坐标系,但是为什么会围绕X旋转180呢？ 
回答：因为我们的API名字叫做Camera 他是以摄像机的角度去 理解做操作的； 可以自己拿手机拍照去 移动里面的物体。">
<meta property="og:image" content="https://ww4.sinaimg.cn/large/006tNbRwly1fc0em565jkg307i07i7wm.gif">
<meta property="og:image" content="https://ww2.sinaimg.cn/large/006tNbRwly1fc0f25baf7g307i07i1l1.gif">
<meta property="og:image" content="https://ww1.sinaimg.cn/large/006tNbRwly1fc0f2btfm7g307i07i7wl.gif">
<meta property="og:image" content="https://ww4.sinaimg.cn/large/006tNbRwly1fc0f6bb02pj30at08cwel.jpg">
<meta property="og:image" content="https://ww3.sinaimg.cn/large/006tNbRwly1fc0fai83kyj30at08cglh.jpg">
<meta property="og:image" content="https://ww1.sinaimg.cn/large/006tNbRwly1fc0l088rrtg307i0dcdwu.gif">
<meta property="og:updated_time" content="2017-01-23T07:17:50.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android-BitmapComposer(类似于AE的合成模式)">
<meta name="twitter:description" content="View,Camera 坐标轴分析


View
Camera
Camera Lib











同view


左手坐标系 判断依据
camera视角的图片锚点坐标系  解释1
同view




解释1：其实用的也是左手坐标系,但是为什么会围绕X旋转180呢？ 
回答：因为我们的API名字叫做Camera 他是以摄像机的角度去 理解做操作的； 可以自己拿手机拍照去 移动里面的物体。">
<meta name="twitter:image" content="https://ww4.sinaimg.cn/large/006tNbRwly1fc0em565jkg307i07i7wm.gif">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.1.0" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />




  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?luhaoaimama1";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




    <title> Android-BitmapComposer(类似于AE的合成模式) · Zone </title>
  </head>

  <body>
    <div class="container">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Zone</a>
</div>

<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            首页
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            归档
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            分类
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            关于
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/message">
            留言
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/github">
            项目
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/friendlinks">
            外联
          </a>
        </li>
      
      
        <li class="menu-search">
          <form>
            <i class="iconfont icon-search" id="open-search"></i>
            <input type="text" class="search-input" id="search-input" />
            <i class="iconfont icon-close" id="close-search"></i>
          </form>
        </li>
      
    </ul>
  
</nav>

<div class="mobile-navbar">
  <div class="mobile-header">
    <div class="mobile-header-logo">
      <a href="/." class="logo">Zone</a>
    </div>

    <div class="mobile-header-icon">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
  <nav class="mobile-menu">
    
      
      <a class="mobile-menu-item" href="/">
        首页
      </a>
    
      
      <a class="mobile-menu-item" href="/archives/">
        归档
      </a>
    
      
      <a class="mobile-menu-item" href="/categories">
        分类
      </a>
    
      
      <a class="mobile-menu-item" href="/about">
        关于
      </a>
    
      
      <a class="mobile-menu-item" href="/message">
        留言
      </a>
    
      
      <a class="mobile-menu-item" href="/github">
        项目
      </a>
    
      
      <a class="mobile-menu-item" href="/friendlinks">
        外联
      </a>
    
  </nav>
</div>
      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          Android-BitmapComposer(类似于AE的合成模式)
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017年1月19日
        </span>
      </div>
    </header>

    
      <div class="post-toc" id="post-toc">
        <h2 class="post-toc-title">文章目录</h2>
        <div class="post-toc-content">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#View-Camera-坐标轴分析"><span class="toc-text">View,Camera 坐标轴分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#理解-translate-与-rotate"><span class="toc-text">理解 translate 与 rotate</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#想要理解上面-先跟我做一些事情"><span class="toc-text">想要理解上面 先跟我做一些事情</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#从中明白了什么"><span class="toc-text">从中明白了什么</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Camera-传说中-移动旋转点的-解释"><span class="toc-text">Camera 传说中 移动旋转点的 解释</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#实例讲解"><span class="toc-text">实例讲解</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reference-amp-Thanks："><span class="toc-text">Reference&Thanks：</span></a></li></ol>
        </div>
      </div>
    

    <div class="post-content">
      
        <a id="more"></a>
<h1 id="View-Camera-坐标轴分析"><a href="#View-Camera-坐标轴分析" class="headerlink" title="View,Camera 坐标轴分析"></a>View,Camera 坐标轴分析</h1><table>
<thead>
<tr>
<th style="text-align:center">View</th>
<th style="text-align:center">Camera</th>
<th style="text-align:center">Camera Lib</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img src="https://ww4.sinaimg.cn/large/006tNbRwly1fc0em565jkg307i07i7wm.gif" alt=""></td>
<td style="text-align:center"><img src="https://ww2.sinaimg.cn/large/006tNbRwly1fc0f25baf7g307i07i1l1.gif" alt=""></td>
<td style="text-align:center"><img src="https://ww1.sinaimg.cn/large/006tNbRwly1fc0f2btfm7g307i07i7wl.gif" alt=""></td>
</tr>
<tr>
<td style="text-align:center"><img src="https://ww4.sinaimg.cn/large/006tNbRwly1fc0f6bb02pj30at08cwel.jpg" alt=""></td>
<td style="text-align:center"><img src="https://ww3.sinaimg.cn/large/006tNbRwly1fc0fai83kyj30at08cglh.jpg" alt=""></td>
<td style="text-align:center">同view</td>
</tr>
<tr>
<td style="text-align:center">左手坐标系 <a href="http://fromwiz.com/share/s/3Hsjaq1-lQ9Q2SChN02Hkyvk1nSH681Fc4lk2iftz320K7Za" target="_blank" rel="external">判断依据</a></td>
<td style="text-align:center">camera视角的图片锚点坐标系  解释1</td>
<td style="text-align:center">同view</td>
</tr>
</tbody>
</table>
<blockquote>
<p>解释1：其实用的也是左手坐标系,但是为什么会围绕X旋转180呢？ </p>
<p>回答：因为我们的API名字叫做Camera 他是以摄像机的角度去 理解做操作的； 可以自己拿手机拍照去 移动里面的物体。现实中不要移动。就会明白了。 </p>
<p>Tips:Camera真实没有移动(因为getLocationX、Y、Z都是没有移动的)，只是以他的角度去理解； </p>
</blockquote>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">    * Gets the x location of the camera.</div><div class="line">    *</div><div class="line">    * <span class="doctag">@see</span> #setLocation(float, float, float)</div><div class="line">    */</div><div class="line">   <span class="keyword">public</span> <span class="keyword">native</span> <span class="function"><span class="keyword">float</span> <span class="title">getLocationX</span><span class="params">()</span></span>;</div></pre></td></tr></table></figure>
<h1 id="理解-translate-与-rotate"><a href="#理解-translate-与-rotate" class="headerlink" title="理解 translate 与 rotate"></a>理解 translate 与 rotate</h1><figure class="highlight zephir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Applies a translation transform on all three axis.</div><div class="line"> * </div><div class="line"> * <span class="doctag">@param</span> x The distance to translate by on the X axis</div><div class="line"> * <span class="doctag">@param</span> y The distance to translate by on the Y axis</div><div class="line"> * <span class="doctag">@param</span> z The distance to translate by on the Z axis</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> native void translate(<span class="keyword">float</span> x, <span class="keyword">float</span> y, <span class="keyword">float</span> z);</div><div class="line"></div><div class="line"> <span class="comment">/**</span></div><div class="line"> * Applies a rotation transform around all three axis.</div><div class="line"> * </div><div class="line"> * <span class="doctag">@param</span> x The angle of rotation around the X axis, in degrees</div><div class="line"> * <span class="doctag">@param</span> y The angle of rotation around the Y axis, in degrees</div><div class="line"> * <span class="doctag">@param</span> z The angle of rotation around the Z axis, in degrees</div><div class="line"> * </div><div class="line"> * <span class="doctag">@see</span> #rotateX(float)</div><div class="line"> * <span class="doctag">@see</span> #rotateY(float)</div><div class="line"> * <span class="doctag">@see</span> #rotateZ(float)</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> native void rotate(<span class="keyword">float</span> x, <span class="keyword">float</span> y, <span class="keyword">float</span> z);</div></pre></td></tr></table></figure>
<p>看到没关键点是-&gt; <strong>axis 的位移与旋转</strong>；</p>
<h2 id="想要理解上面-先跟我做一些事情"><a href="#想要理解上面-先跟我做一些事情" class="headerlink" title="想要理解上面 先跟我做一些事情"></a>想要理解上面 先跟我做一些事情</h2><blockquote>
<p>锚点：左上角点</p>
</blockquote>
<p>1.拿起你的手机  平行面对你，已左上角为手机坐标系原点(任何时候 包括 旋转位移以后)。 </p>
<ul>
<li>围绕Y轴做旋转45，然后X位移一段距离distanceX。在旋转75°</li>
</ul>
<h2 id="从中明白了什么"><a href="#从中明白了什么" class="headerlink" title="从中明白了什么"></a>从中明白了什么</h2><blockquote>
<p>锚点：左上角点</p>
</blockquote>
<p>1.明白什么叫做 axis 的位移与旋转。 就是每次造作都是以 手机左上角(相当于咱们的图片左上角)为坐标系</p>
<ol>
<li>从整体来看我们经过了 三次操作，以每次操作之前，手机左上角的点为例，第一次操作点 记为 operate1，依次 operate2 ，operate3.</li>
</ol>
<p>那么从整体来看 我相当于  operate1 X轴:distanceX的点 rorate1 围绕operate1 旋转45°，然后围绕本身operate3 75°</p>
<ul>
<li>既 旋转之后 +位移操作，就是相当于 <strong>[旋转之前+位移]之后的点</strong> 围绕 <strong>旋转之前的点</strong> 旋转，</li>
<li>旋转不加位移  就相当于 [锚点] 旋转。</li>
</ul>
<blockquote>
<p>不管做了多少次操作都遵循这个 规律；</p>
</blockquote>
<h1 id="Camera-传说中-移动旋转点的-解释"><a href="#Camera-传说中-移动旋转点的-解释" class="headerlink" title="Camera 传说中 移动旋转点的 解释"></a>Camera 传说中 移动旋转点的 解释</h1><figure class="highlight pony"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="type">Matrix</span> temp = <span class="function"><span class="keyword">new</span> <span class="title">Matrix</span>();		<span class="comment">// 临时Matrix变量</span></span></div><div class="line"><span class="title">this</span>.<span class="title">getMatrix</span>(temp);			<span class="comment">// 获取Matrix</span></div><div class="line"><span class="title">temp</span>.<span class="title">preTranslate</span>(-centerX, -centerY);	<span class="comment">// 使用pre将旋转中心移动到和Camera位置相同。</span></div><div class="line"><span class="title">temp</span>.<span class="title">postTranslate</span>(centerX, centerY);	<span class="comment">// 使用post将图片(View)移动到原来的位置</span></div></pre></td></tr></table></figure>
<p>temp.preTranslate操作:是把最开的图片移动位置。</p>
<blockquote>
<p>center为例: 左上角(锚点)是center点了,因为开始的图片变了位置,左上角依然没变</p>
</blockquote>
<p>temp.postTranslate操作 移动的是 合成坐标系(摄像机 那个世界的永远<strong>不随camera方法变换</strong>的坐标系)。</p>
<blockquote>
<p>Tips: 旋转的中心点依然是左上角点(锚点 例子中的center点),而不是post中的点。 </p>
</blockquote>
<p>##最后我还要提示下： </p>
<blockquote>
<p>我们的视角 就是view坐标系(所有View 大小 padding等等都是参考此来设计的)；</p>
</blockquote>
<ul>
<li>camera translate,rotate 是在合成坐标系里 的视角 ,位移旋转， 位移和旋转的值都是相对于 合成坐标系里 的视角,因为里面有摄像机 <blockquote>
<p>假如camera向下移动100 以我们的视角可能是89等,因为以camera坐标系的视角(包含摄像机 Z轴 视差等等因素)判定的；</p>
</blockquote>
</li>
<li>Matrix postTranslate 系列,则是 对于合成坐标系的操作， 更改的位置和旋转等。都是 相对于View坐标系的值 <blockquote>
<p>假如Matrix向下移动100  就是100 这是以View坐标系既我们的视角来判定的；</p>
</blockquote>
</li>
</ul>
<h3 id="实例讲解"><a href="#实例讲解" class="headerlink" title="实例讲解"></a>实例讲解</h3><p><img src="https://ww1.sinaimg.cn/large/006tNbRwly1fc0l088rrtg307i0dcdwu.gif" alt=""></p>
<p>左图关键代码：</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">camera</span>.save();</div><div class="line">  <span class="keyword">camera</span>.rotateX(-rotateDegree);</div><div class="line">  <span class="keyword">camera</span>.getMatrix(<span class="keyword">matrix</span>);</div><div class="line">  <span class="keyword">camera</span>.restore();</div><div class="line"></div><div class="line">  <span class="comment">// -viewWidth / 2 保持着竖线高度不变的，其他会倾斜；</span></div><div class="line">  <span class="keyword">matrix</span>.preTranslate(-viewWidth / <span class="number">2</span>, <span class="number">0</span>);</div><div class="line">  <span class="keyword">matrix</span>.postTranslate(viewWidth / <span class="number">2</span>, (<span class="keyword">float</span>) axisY);</div></pre></td></tr></table></figure>
<p>右图关键代码：把 <strong>postTranslate</strong>移动的 移动到了<strong>camera.transalte</strong></p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">camera</span>.save();</div><div class="line">       <span class="keyword">camera</span>.rotateX(-rotateDegree);</div><div class="line">       <span class="keyword">camera</span>.translte(<span class="number">0</span>,(<span class="keyword">float</span>) axisY,<span class="number">0</span>)</div><div class="line">       <span class="keyword">camera</span>.getMatrix(<span class="keyword">matrix</span>);</div><div class="line">       <span class="keyword">camera</span>.restore();</div><div class="line"></div><div class="line">       <span class="comment">// -viewWidth / 2 保持着竖线高度不变的，其他会倾斜；</span></div><div class="line">       <span class="keyword">matrix</span>.preTranslate(-viewWidth / <span class="number">2</span>, <span class="number">0</span>);</div><div class="line">       <span class="keyword">matrix</span>.postTranslate(viewWidth / <span class="number">2</span>, <span class="number">0</span>);</div></pre></td></tr></table></figure>
<blockquote>
<p>这里的问题是,0度的时候 还能看到？因为你camera.translte(0,(float) axisY,0),因为Y不在是0,和摄像机不保持相同高度后是可以看到的。所以这里用matrix.postTranslate比较好</p>
<p>这还算好的 如果摄像机移动Z轴的话  会出现和严重的问题,因为这仅仅是一段代码补全就暂且不说了；</p>
</blockquote>
<h1 id="Reference-amp-Thanks："><a href="#Reference-amp-Thanks：" class="headerlink" title="Reference&amp;Thanks："></a>Reference&amp;Thanks：</h1><p><a href="https://github.com/race604/WaveLoading" target="_blank" rel="external">https://github.com/race604/WaveLoading</a></p>

      
    </div>

    
      <footer class="post-footer">
        <div class="post-tags">
          
            <a href="/tags/android/">android</a>
          
            <a href="/tags/bitmap/">bitmap</a>
          
        </div>

        
  <nav class="post-nav">
    
      <a class="prev" href="/2017/01/19/BitmapComposer/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Android-BitmapComposer(类似于AE的合成模式)</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/2016/12/18/drawText/">
        <span class="next-text nav-default">Android-drawText()详解</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    
  </article>


          </div>
          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2017/01/19/Camera调研/"
           data-title="Android-BitmapComposer(类似于AE的合成模式)" data-url="https://luhaoaimama1.github.io/2017/01/19/Camera调研/">
      </div>
    
  </div>

        </div>  
      </main>

      <footer id="footer" class="footer">
  <div class="social-links">
    
      
        
          <a href="mailto:1149324777@email.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
        
          <a href="https://github.com/luhaoaimama1" class="iconfont icon-github" title="github"></a>
        
      
    
      
        
          <a href="http://weibo.com/u/2193119237" class="iconfont icon-weibo" title="weibo"></a>
        
      
    
      
    
    
    
  </div>


<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2015 - 
    
    2017

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Zone</span>
  </span>
</div>
      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"luhaoaimama1"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>



    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  

    <script type="text/javascript" src="/js/src/even.js?v=2.1.0"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.1.0"></script>

  </body>
</html>