<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="Rxjava2总结"/>







  <link rel="alternate" href="/atom.xml" title="Zone">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.1.0" />



<link rel="canonical" href="https://luhaoaimama1.github.io/2017/07/31/rxjava/"/>


<meta name="description" content="Rxjava2基础认知
形式正确的有限Observable调用观察者的onCompleted正好一次或者它的onError正好一次，而且此后不能再调用观察者的任何其它方法。如果onComplete 或者 onError 走任何一个 都会 主动解除订阅关系；

如果解除订阅关系以后在发射 onError 则会 报错;而发射onComplete则不会。
注意解除订阅关系 还是可以发射 onNext">
<meta property="og:type" content="article">
<meta property="og:title" content="Rxjava2总结">
<meta property="og:url" content="https://luhaoaimama1.github.io/2017/07/31/rxjava/index.html">
<meta property="og:site_name" content="Zone">
<meta property="og:description" content="Rxjava2基础认知
形式正确的有限Observable调用观察者的onCompleted正好一次或者它的onError正好一次，而且此后不能再调用观察者的任何其它方法。如果onComplete 或者 onError 走任何一个 都会 主动解除订阅关系；

如果解除订阅关系以后在发射 onError 则会 报错;而发射onComplete则不会。
注意解除订阅关系 还是可以发射 onNext">
<meta property="og:image" content="https://ww1.sinaimg.cn/large/006tNc79gy1fhyjg4qv2fj30v204ot9a.jpg">
<meta property="og:image" content="https://ww3.sinaimg.cn/large/006tKfTcgy1fhzely2zzjj31am0r2go8.jpg">
<meta property="og:image" content="https://ww4.sinaimg.cn/large/006tKfTcgy1fi33z4i9jlj30mi0gp74i.jpg">
<meta property="og:updated_time" content="2017-07-31T09:10:18.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Rxjava2总结">
<meta name="twitter:description" content="Rxjava2基础认知
形式正确的有限Observable调用观察者的onCompleted正好一次或者它的onError正好一次，而且此后不能再调用观察者的任何其它方法。如果onComplete 或者 onError 走任何一个 都会 主动解除订阅关系；

如果解除订阅关系以后在发射 onError 则会 报错;而发射onComplete则不会。
注意解除订阅关系 还是可以发射 onNext">
<meta name="twitter:image" content="https://ww1.sinaimg.cn/large/006tNc79gy1fhyjg4qv2fj30v204ot9a.jpg">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.1.0" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />




  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?luhaoaimama1";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




    <title> Rxjava2总结 · Zone </title>
  </head>

  <body>
    <div class="container">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Zone</a>
</div>

<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            首页
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            归档
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            分类
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            关于
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/message">
            留言
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/github">
            项目
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/friendlinks">
            外联
          </a>
        </li>
      
      
        <li class="menu-search">
          <form>
            <i class="iconfont icon-search" id="open-search"></i>
            <input type="text" class="search-input" id="search-input" />
            <i class="iconfont icon-close" id="close-search"></i>
          </form>
        </li>
      
    </ul>
  
</nav>

<div class="mobile-navbar">
  <div class="mobile-header">
    <div class="mobile-header-logo">
      <a href="/." class="logo">Zone</a>
    </div>

    <div class="mobile-header-icon">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
  <nav class="mobile-menu">
    
      
      <a class="mobile-menu-item" href="/">
        首页
      </a>
    
      
      <a class="mobile-menu-item" href="/archives/">
        归档
      </a>
    
      
      <a class="mobile-menu-item" href="/categories">
        分类
      </a>
    
      
      <a class="mobile-menu-item" href="/about">
        关于
      </a>
    
      
      <a class="mobile-menu-item" href="/message">
        留言
      </a>
    
      
      <a class="mobile-menu-item" href="/github">
        项目
      </a>
    
      
      <a class="mobile-menu-item" href="/friendlinks">
        外联
      </a>
    
  </nav>
</div>
      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          Rxjava2总结
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017年7月31日
        </span>
      </div>
    </header>

    
      <div class="post-toc" id="post-toc">
        <h2 class="post-toc-title">文章目录</h2>
        <div class="post-toc-content">
          <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Rxjava2基础认知"><span class="toc-text">Rxjava2基础认知</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#基础概念"><span class="toc-text">基础概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建操作"><span class="toc-text">创建操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#过滤操作"><span class="toc-text">过滤操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#辅助操作"><span class="toc-text">辅助操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#变换操作"><span class="toc-text">变换操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#合并操作符"><span class="toc-text">合并操作符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#条件操作"><span class="toc-text">条件操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#错误处理"><span class="toc-text">错误处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#阻塞操作"><span class="toc-text">阻塞操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#组合操作"><span class="toc-text">组合操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Subjects"><span class="toc-text">Subjects</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Single与Completable"><span class="toc-text">Single与Completable</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自定义操作符"><span class="toc-text">自定义操作符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#实用技巧"><span class="toc-text">实用技巧</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference-amp-Thanks："><span class="toc-text">Reference&Thanks：</span></a></li></ol>
        </div>
      </div>
    

    <div class="post-content">
      
        <h2 id="Rxjava2基础认知"><a href="#Rxjava2基础认知" class="headerlink" title="Rxjava2基础认知"></a>Rxjava2基础认知</h2><ul>
<li><p>形式正确的有限Observable<br>调用观察者的onCompleted正好一次或者它的onError正好一次，而且此后不能再调用观察者的任何其它方法。如果onComplete 或者 onError 走任何一个 都会 主动解除订阅关系；</p>
<ul>
<li>如果解除订阅关系以后在发射 onError 则会 报错;而发射onComplete则不会。</li>
<li>注意解除订阅关系 还是可以发射 onNext</li>
</ul>
</li>
<li><p>Disposable类:</p>
<ul>
<li>dispose():主动解除订阅</li>
<li>isDisposed():查询是否解除订阅 true 代表 已经解除订阅</li>
</ul>
</li>
<li><p>CompositeDisposable类:可以快速解除所有添加的Disposable类<br>每当我们得到一个Disposable时就调用CompositeDisposable.add()将它添加到容器中, 在退出的时候, 调用CompositeDisposable.clear() 即可快速解除.</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">CompositeDisposable compositeDisposable=new CompositeDisposable();</div><div class="line">Observable.create(new ObservableOnSubscribe<span class="tag">&lt;<span class="name">Integer</span>&gt;</span>() &#123;</div><div class="line">            @Override</div><div class="line">            public void subscribe(ObservableEmitter<span class="tag">&lt;<span class="name">Integer</span>&gt;</span> emitter) throws Exception &#123;</div><div class="line">                emitter.onNext(1);</div><div class="line">                emitter.onComplete();或者 emitter.onError(new Throwable("O__O "));</div><div class="line">            &#125;</div><div class="line">        &#125;).subscribe(new Observer<span class="tag">&lt;<span class="name">Integer</span>&gt;</span>() &#123;</div><div class="line"></div><div class="line">            private Disposable mDisposable;</div><div class="line">            @Override</div><div class="line">            public void onSubscribe(Disposable d) &#123;</div><div class="line">                <span class="comment">&lt;!-- 订阅   --&gt;</span></div><div class="line">                mDisposable = d;</div><div class="line">                <span class="comment">&lt;!-- 添加到容器中 --&gt;</span></div><div class="line">                compositeDisposable.add(d);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            @Override</div><div class="line">            public void onNext(Integer value) &#123;</div><div class="line">                <span class="comment">&lt;!-- 判断mDisposable.isDisposed() 如果解除了则不需要处理 --&gt;</span></div><div class="line">            &#125;</div><div class="line"></div><div class="line">            @Override</div><div class="line">            public void onError(Throwable e) &#123;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            @Override</div><div class="line">            public void onComplete() &#123;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        <span class="comment">&lt;!-- 解除所有订阅者 --&gt;</span></div><div class="line">        compositeDisposable.clear();</div></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h2><ul>
<li>Scheduler scheduler</li>
</ul>
<blockquote>
<p>timer() alt+点击timer可查看 关于timer的方法 可以看到时候有这个参数的变体!</p>
</blockquote>
<p><img src="https://ww1.sinaimg.cn/large/006tNc79gy1fhyjg4qv2fj30v204ot9a.jpg" alt=""></p>
<ul>
<li>Callable<u> bufferSupplier:自定义装载的容器</u></li>
</ul>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Observable.range(<span class="number">1</span>, <span class="number">10</span>)</div><div class="line">           <span class="regexp">//</span>() -&gt; <span class="keyword">new</span> ArrayList&lt;&gt;() 则是bufferSupplier</div><div class="line">           .buffer(<span class="number">2</span>, <span class="number">1</span>,<span class="function"><span class="params">()</span> -&gt;</span> <span class="keyword">new</span> ArrayList&lt;&gt;())</div><div class="line">           .subscribe(integers -&gt; System.out.println(integers));</div></pre></td></tr></table></figure>
<h2 id="创建操作"><a href="#创建操作" class="headerlink" title="创建操作"></a>创建操作</h2><ul>
<li>create : 创建一个具有发射能力的Observable</li>
</ul>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Observable.create(e -&gt; &#123;</div><div class="line">    e.onNext(<span class="string">"Love"</span>)<span class="comment">;</span></div><div class="line">    e.onNext(<span class="string">"For"</span>)<span class="comment">;</span></div><div class="line">    e.onNext(<span class="string">"You!"</span>)<span class="comment">;</span></div><div class="line">    e.onComplete()<span class="comment">;</span></div><div class="line">&#125;).<span class="keyword">subscribe(s </span>-&gt; System.out.println(s))<span class="comment">;</span></div></pre></td></tr></table></figure>
<ul>
<li>just:只是简单的原样发射,可将数组或Iterable当做单个数据。它接受一至九个参数</li>
</ul>
<figure class="highlight golo"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Observable</span>.just(<span class="string">"Love"</span>, <span class="string">"For"</span>, <span class="string">"You!"</span>)</div><div class="line">                .subscribe(s -&gt; System.out.<span class="keyword">println</span>(s));</div></pre></td></tr></table></figure>
<ul>
<li>empty:创建一个不发射任何数据但是正常终止的Observable</li>
<li>never:创建一个不发射数据也不终止的Observable</li>
<li>error:创建一个不发射数据以一个错误终止的Observable</li>
</ul>
<figure class="highlight golo"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Observable</span>.empty();</div><div class="line"><span class="keyword">Observable</span>.never();</div><div class="line"><span class="keyword">Observable</span>.error(new Throwable(<span class="string">"O__O"</span>))</div></pre></td></tr></table></figure>
<ul>
<li>timer 在延迟一段给定的时间后发射一个简单的数字0</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.timer</span>(1000, <span class="selector-tag">TimeUnit</span><span class="selector-class">.MILLISECONDS</span>)</div><div class="line">              <span class="selector-class">.subscribe</span>(<span class="selector-tag">s</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="selector-tag">s</span>));</div></pre></td></tr></table></figure>
<ul>
<li>range:<ul>
<li>start:起始值</li>
<li>count:一个是范 围的数据的数目。0不发送 ，负数 异常</li>
</ul>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Observable.<span class="keyword">range</span>(<span class="number">5</span>, <span class="number">3</span>)</div><div class="line">        <span class="comment">//输出 5,6,7</span></div><div class="line">        .subscribe(s -&gt; System.out.<span class="built_in">println</span>(s));</div></pre></td></tr></table></figure>
<ul>
<li>intervalRange<ul>
<li>start,count:同range</li>
<li>initialDelay 发送第一个值的延迟时间</li>
<li>period  每两个发射物的间隔时间</li>
<li>unit,scheduler 额你懂的</li>
</ul>
</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.intervalRange</span>(5, 100, 3000, 100,</div><div class="line">                <span class="selector-tag">TimeUnit</span><span class="selector-class">.MILLISECONDS</span>, <span class="selector-tag">Schedulers</span><span class="selector-class">.io</span>())</div><div class="line">                <span class="selector-class">.subscribe</span>(<span class="selector-tag">s</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="selector-tag">s</span>));</div></pre></td></tr></table></figure>
<ul>
<li>interval:相当于intervalRange的start=0；<blockquote>
<p>period 这个值一旦设定后是不可变化的</p>
</blockquote>
</li>
</ul>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//period 以后的美每次间隔 这个值一旦设定后是不可变化的  所以 count方法无效的！</span></div><div class="line"><span class="keyword">int</span>[] s = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">0</span>&#125;;</div><div class="line"> Observable.interval(<span class="number">3000</span>, <span class="number">100</span> + <span class="keyword">count</span>(s), TimeUnit.MILLISECONDS, Schedulers.io())</div><div class="line">         .subscribe(s2 -&gt; System.out.<span class="keyword">println</span>(s2));</div><div class="line"></div><div class="line"> <span class="keyword">private</span> <span class="keyword">int</span> <span class="keyword">count</span>(<span class="keyword">int</span>[] s) &#123;</div><div class="line">         <span class="keyword">int</span> result = s[<span class="number">0</span>] * <span class="number">1000</span>;</div><div class="line">         s[<span class="number">0</span>] = s[<span class="number">0</span>] + <span class="number">1</span>;</div><div class="line">         <span class="keyword">return</span> result;</div><div class="line">     &#125;</div></pre></td></tr></table></figure>
<ul>
<li>defer 直到有观察者订阅时才创建Observable，并且为每个观察者创建一个新的Observable</li>
</ul>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Observable.defer<span class="function"><span class="params">(() -&gt; Observable.just(<span class="string">"Love"</span>, <span class="string">"For"</span>, <span class="string">"You!"</span>))</span></span></div><div class="line">              .<span class="title">subscribe</span><span class="params">(s -&gt; System.out.println(s))</span>;</div></pre></td></tr></table></figure>
<ul>
<li><p>from系列</p>
<ul>
<li><p>fromArray</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Integer[] items = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</div><div class="line">       Observable.fromArray(items).subscribe(</div><div class="line">               <span class="type">integer</span> -&gt; System.out.println(<span class="type">integer</span>));</div></pre></td></tr></table></figure>
</li>
<li><p>fromCallable</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Observable.fromCallable<span class="function"><span class="params">(() -&gt; Arrays.asList(<span class="string">"hello"</span>, <span class="string">"gaga"</span>))</span></span></div><div class="line">                .<span class="title">subscribe</span><span class="params">(strings -&gt; System.out.println(strings))</span></div></pre></td></tr></table></figure>
</li>
<li><p>fromIterable</p>
<figure class="highlight vhdl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Observable.fromIterable(Arrays.&lt;<span class="built_in">String</span>&gt;asList(<span class="string">"one"</span>, <span class="string">"two"</span>, <span class="string">"three"</span>))</div><div class="line">             .subscribe(<span class="built_in">integer</span> -&gt; System.<span class="keyword">out</span>.println(<span class="built_in">integer</span>));</div></pre></td></tr></table></figure>
</li>
<li><p>fromFuture</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.fromFuture</span>(<span class="selector-tag">Observable</span><span class="selector-class">.just</span>(1)<span class="selector-class">.toFuture</span>())</div><div class="line">               <span class="selector-class">.doOnComplete</span>(() <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.println</span>("<span class="selector-tag">complete</span>"))</div><div class="line">               <span class="selector-class">.subscribe</span>();</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="过滤操作"><a href="#过滤操作" class="headerlink" title="过滤操作"></a>过滤操作</h2><ul>
<li>elementAt:只发射第N项数据</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 无默认值版本 --&gt;</span></div><div class="line"> Observable.just(1,2)</div><div class="line">            .elementAt(0)</div><div class="line">            .subscribe(o -&gt; System.out.print(o ));//结果:1</div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 带默认值的变体版本 --&gt;</span></div><div class="line">Observable.range(0, 10)</div><div class="line">//        如果索引值大于数据 项数，它会发射一个默认值(通过额外的参数指定)，而不是抛出异常。</div><div class="line">//    但是如果你传递一 个负数索引值，它仍然会抛出一个 IndexOutOfBoundsException 异常。</div><div class="line">                .elementAt(100, -100)</div><div class="line">                .subscribe(o -&gt; System.out.print(o + "\t"));</div></pre></td></tr></table></figure>
<ul>
<li><p>IgnoreElements:如果你不关心一个Observable发射的数据，但是希望在它完成时或遇到错误终止时收到通知</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.range</span>(0, 10)</div><div class="line">               <span class="selector-class">.ignoreElements</span>()</div><div class="line">               <span class="selector-class">.subscribe</span>(() <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.println</span>("<span class="selector-tag">complete</span>")</div><div class="line">                       , <span class="selector-tag">throwable</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.println</span>("<span class="selector-tag">throwable</span>"));</div></pre></td></tr></table></figure>
</li>
<li><p>take系列</p>
<ul>
<li><p>变体 count系列:只发射前面的N项数据</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.range</span>(0,10)</div><div class="line">               <span class="selector-class">.take</span>(3)</div><div class="line">               <span class="selector-class">.subscribe</span>(<span class="selector-tag">o</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.print</span>(<span class="selector-tag">o</span> + "\<span class="selector-tag">t</span>"))</div></pre></td></tr></table></figure>
</li>
<li><p>变体 time系列: 发射Observable开始的那段时间发射 的数据，</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.range</span>(0,10)</div><div class="line">          <span class="selector-class">.take</span>(100, <span class="selector-tag">TimeUnit</span><span class="selector-class">.MILLISECONDS</span>)</div><div class="line">          <span class="selector-class">.subscribe</span>(<span class="selector-tag">o</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.print</span>(<span class="selector-tag">o</span> + "\<span class="selector-tag">t</span>"));</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>takeLast</p>
<ul>
<li><p>变体 count系列:只发射后面的N项数据</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.range</span>(0,10)</div><div class="line">                    <span class="selector-class">.takeLast</span>(3)</div><div class="line">                    <span class="selector-class">.subscribe</span>(<span class="selector-tag">o</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.print</span>(<span class="selector-tag">o</span> + "\<span class="selector-tag">t</span>"));</div></pre></td></tr></table></figure>
</li>
<li><p>变体 time系列: 发射在原始Observable的生命周 期内最后一段时间内发射的数据</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.range</span>(0,10)</div><div class="line">               <span class="selector-class">.takeLast</span>(100, <span class="selector-tag">TimeUnit</span><span class="selector-class">.MILLISECONDS</span>)</div><div class="line">               <span class="selector-class">.subscribe</span>(<span class="selector-tag">o</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.print</span>(<span class="selector-tag">o</span> + "\<span class="selector-tag">t</span>"));</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>takeUntil:发送complete的结束条件 当然发送结束之前也会包括这个值</p>
</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Observable.just(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</div><div class="line">        <span class="comment">//发送complete的结束条件 当然发送结束之前也会包括这个值</span></div><div class="line">        .takeUntil(<span class="type">integer</span> -&gt;  <span class="type">integer</span>&gt;<span class="number">3</span>)</div><div class="line">        .subscribe(o -&gt; System.out.print(o + <span class="string">"<span class="subst">\t</span>"</span>));<span class="comment">//2,3,4</span></div></pre></td></tr></table></figure>
<ul>
<li>takeWhile:当不满足这个条件 会发送结束 不会包括这个值</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Observable.just(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</div><div class="line">        <span class="comment">//当不满足这个条件 会发送结束 不会包括这个值</span></div><div class="line">        .takeWhile(<span class="type">integer</span> -&gt;<span class="type">integer</span>&lt;=<span class="number">4</span> )</div><div class="line">        .subscribe(o -&gt; System.out.print(o + <span class="string">"<span class="subst">\t</span>"</span>));<span class="comment">//2,3,4</span></div></pre></td></tr></table></figure>
<ul>
<li><p>skip系列</p>
<ul>
<li><p>变体 count系列:丢弃Observable发射的前N项数据</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.range</span>(0,5)</div><div class="line">               <span class="selector-class">.skip</span>(3)</div><div class="line">               <span class="selector-class">.subscribe</span>(<span class="selector-tag">o</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.print</span>(<span class="selector-tag">o</span> + "\<span class="selector-tag">t</span>"));</div></pre></td></tr></table></figure>
</li>
<li><p>变体 time系列:丢弃原始Observable开始的那段时间发 射的数据</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.range</span>(0,5)</div><div class="line">               <span class="selector-class">.skip</span>(3)</div><div class="line">               <span class="selector-class">.subscribe</span>(<span class="selector-tag">o</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.print</span>(<span class="selector-tag">o</span> + "\<span class="selector-tag">t</span>"));</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>skipLast</p>
<ul>
<li><p>变体 count系列:丢弃Observable发射的前N项数据</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.range</span>(0,5)</div><div class="line">               <span class="selector-class">.skipLast</span>(3)</div><div class="line">               <span class="selector-class">.subscribe</span>(<span class="selector-tag">o</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.print</span>(<span class="selector-tag">o</span> + "\<span class="selector-tag">t</span>"));</div></pre></td></tr></table></figure>
</li>
<li><p>变体 time系列:丢弃在原始Observable的生命周 期内最后一段时间内发射的数据</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.range</span>(0,10)</div><div class="line">             <span class="selector-class">.skipLast</span>(100, <span class="selector-tag">TimeUnit</span><span class="selector-class">.MILLISECONDS</span>)</div><div class="line">             <span class="selector-class">.subscribe</span>(<span class="selector-tag">o</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.print</span>(<span class="selector-tag">o</span> + "\<span class="selector-tag">t</span>"));</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>distinct:去重</p>
<ul>
<li><p>keySelector:这个函数根据原始Observable发射的数据项产生一个 Key，然后，比较这些Key而不是数据本身，来判定两个数据是否是不同的</p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">  Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">            <span class="comment">//这个函数根据原始Observable发射的数据项产生一个 Key，</span></div><div class="line">            <span class="comment">// 然后，比较这些Key而不是数据本身，来判定两个数据是否是不同的</span></div><div class="line">            .<span class="function"><span class="title">distinct</span>(<span class="keyword">integer</span> -&gt;</span> Math.random())</div><div class="line">            .<span class="function"><span class="title">subscribe</span>(o -&gt;</span> System.out.print(o + <span class="string">"\t"</span>));</div><div class="line">日志:</div><div class="line">原因 key不同 所以当做数据不同处理</div><div class="line"><span class="number">1</span>	<span class="number">2</span>	<span class="number">1</span>	<span class="number">2</span>	<span class="number">3</span></div></pre></td></tr></table></figure>
</li>
<li><p>无参版本 就是内部实现了的keySelector通过生成的key就是value本身</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.just</span>(1, 2, 1, 2, 3)</div><div class="line">             <span class="selector-class">.distinct</span>()</div><div class="line">             <span class="selector-class">.subscribe</span>(<span class="selector-tag">o</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.print</span>(<span class="selector-tag">o</span> + "\<span class="selector-tag">t</span>"));</div><div class="line"> 日志:</div><div class="line"> 1	2	3</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>distinctUntilChanged(相邻去重):它只判定一个数据和它的直接前驱是 否是不同的。</p>
<blockquote>
<p>其他概念与distinct一样</p>
</blockquote>
</li>
<li><p>throttleWithTimeout/debounce:</p>
</li>
</ul>
<blockquote>
<p>操作符会过滤掉发射速率过快的数据项<br>throttleWithTimeout/debounce： 含义相同<br>如果发送数据后 指定时间段内没有新数据的话 。则发送这条<br>如果有新数据 则以这个新数据作为将要发送的数据项，并且重置这个时间段，重新计时。</p>
</blockquote>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">    <span class="selector-tag">Observable</span><span class="selector-class">.create</span>(e -&gt; &#123;</div><div class="line">            <span class="selector-tag">e</span><span class="selector-class">.onNext</span>(<span class="string">"onNext 0"</span>);</div><div class="line">            <span class="selector-tag">Thread</span><span class="selector-class">.sleep</span>(<span class="number">100</span>);</div><div class="line">            <span class="selector-tag">e</span><span class="selector-class">.onNext</span>(<span class="string">"onNext 1"</span>);</div><div class="line">            <span class="selector-tag">Thread</span><span class="selector-class">.sleep</span>(<span class="number">230</span>);</div><div class="line">            <span class="selector-tag">e</span><span class="selector-class">.onNext</span>(<span class="string">"onNext 2"</span>);</div><div class="line">            <span class="selector-tag">Thread</span><span class="selector-class">.sleep</span>(<span class="number">300</span>);</div><div class="line">            <span class="selector-tag">e</span><span class="selector-class">.onNext</span>(<span class="string">"onNext 3"</span>);</div><div class="line">            <span class="selector-tag">Thread</span><span class="selector-class">.sleep</span>(<span class="number">400</span>);</div><div class="line">            <span class="selector-tag">e</span><span class="selector-class">.onNext</span>(<span class="string">"onNext 4"</span>);</div><div class="line">            <span class="selector-tag">Thread</span><span class="selector-class">.sleep</span>(<span class="number">500</span>);</div><div class="line">            <span class="selector-tag">e</span><span class="selector-class">.onNext</span>(<span class="string">"onNext 5"</span>);</div><div class="line">            <span class="selector-tag">e</span><span class="selector-class">.onNext</span>(<span class="string">"onNext 6"</span>);</div><div class="line">        &#125;)</div><div class="line">                <span class="selector-class">.debounce</span>(<span class="number">330</span>, TimeUnit.MILLISECONDS)</div><div class="line"><span class="comment">//                .throttleWithTimeout(330, TimeUnit.MILLISECONDS)</span></div><div class="line">                <span class="selector-class">.subscribeOn</span>(Schedulers.newThread())</div><div class="line">                <span class="selector-class">.observeOn</span>(Schedulers.newThread())</div><div class="line">                <span class="selector-class">.subscribe</span>(o -&gt; System.out.println(o));<span class="comment">//结果 3 4 6</span></div></pre></td></tr></table></figure>
<ul>
<li><p>filter:只发射通过了谓词测试的数据项</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Observable.range(<span class="number">0</span>, <span class="number">10</span>)</div><div class="line">        <span class="comment">//过滤掉false的元素</span></div><div class="line">        .filter(<span class="type">integer</span> -&gt; <span class="type">integer</span> % <span class="number">2</span> == <span class="number">0</span>)</div><div class="line">        .subscribe(o -&gt; System.out.print(o + <span class="string">"<span class="subst">\t</span>"</span>));</div></pre></td></tr></table></figure>
</li>
<li><p>ofType:ofType 是 filter 操作符的一个特殊形式。它过滤一个Observable只返回指定类型的数据</p>
</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Observable.just(<span class="number">0</span>, <span class="string">"what?"</span>, <span class="number">1</span>, <span class="string">"String"</span>, <span class="number">3</span>)</div><div class="line">             <span class="comment">//ofType 是 filter 操作符的一个特殊形式。它过滤一个Observable只返回指定类型的数据。</span></div><div class="line">             .ofType(String.class)</div><div class="line">             .subscribe(o -&gt; System.out.print(o + <span class="string">"<span class="subst">\t</span>"</span>));</div></pre></td></tr></table></figure>
<ul>
<li>first:只发射第一项(或者满足某个条件的第一项)数 感觉和take(1)  elementAt(0)差不多</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Observable.range(<span class="number">0</span>, <span class="number">10</span>)</div><div class="line">          <span class="comment">//如果元数据没有发送  则有发送默认值</span></div><div class="line">          .first(<span class="number">-1</span>)</div><div class="line">          .subscribe(o -&gt; System.out.print(o + <span class="string">"<span class="subst">\t</span>"</span>));</div></pre></td></tr></table></figure>
<ul>
<li>last:只发射最后一项(或者满足某个条件的最后一项)数据 感觉和takeLast(1)差不多</li>
</ul>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.empty</span>()</div><div class="line">              <span class="comment">//如果元数据没有发送  则有发送默认值</span></div><div class="line">              <span class="selector-class">.last</span>(-<span class="number">1</span>)</div><div class="line">              <span class="selector-class">.subscribe</span>(o -&gt; System.out.print(o + <span class="string">"\t"</span>));</div></pre></td></tr></table></figure>
<ul>
<li>sample/throttleLast: 周期采样后 发送最后的数据</li>
<li>throttleFirst:周期采样 的第一条数据 发送<blockquote>
<p>注意: 如果是已经被发送过的 则不会继续发送</p>
</blockquote>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"> Observable.create(e -&gt; &#123;</div><div class="line">            e.onNext("onNext 0");</div><div class="line">            Thread.sleep(100);</div><div class="line">            e.onNext("onNext 1");</div><div class="line">            Thread.sleep(50);</div><div class="line">            e.onNext("onNext 2");</div><div class="line">            Thread.sleep(70);</div><div class="line">            e.onNext("onNext 3");</div><div class="line">            Thread.sleep(200);</div><div class="line">            e.onNext("onNext 4");</div><div class="line">            e.onNext("onNext 5");</div><div class="line">        &#125;)</div><div class="line">                .subscribeOn(Schedulers.newThread())</div><div class="line">                .observeOn(Schedulers.newThread())</div><div class="line">                <span class="comment">&lt;!--  结果 : onNext 2	onNext 3	onNext 5	--&gt;</span></div><div class="line">                .sample(200, TimeUnit.MILLISECONDS,Schedulers.newThread())</div><div class="line">                <span class="comment">&lt;!--  结果 : onNext 2	onNext 3	onNext 5	--&gt;</span></div><div class="line">//                .throttleLast(200, TimeUnit.MILLISECONDS,Schedulers.newThread())</div><div class="line">                <span class="comment">&lt;!--  结果 : onNext 0	onNext 3	onNext 4	--&gt;</span></div><div class="line">//                .throttleFirst(200, TimeUnit.MILLISECONDS,Schedulers.newThread())</div><div class="line">                .subscribe(o -&gt; System.out.print(o + "\t"));</div></pre></td></tr></table></figure>
<h2 id="辅助操作"><a href="#辅助操作" class="headerlink" title="辅助操作"></a>辅助操作</h2><ul>
<li>repeat:不是创建一个Observable,而是重复发射原始,Observable的数据序列，这个序列或者是无限的，或者通过 repeat(n) 指定重复次数</li>
</ul>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.just</span>(<span class="string">"Love"</span>, <span class="string">"For"</span>, <span class="string">"You!"</span>)</div><div class="line">          <span class="selector-class">.repeat</span>(<span class="number">3</span>)<span class="comment">//重复三次</span></div><div class="line">          <span class="selector-class">.subscribe</span>(s -&gt; System.out.println(s));</div></pre></td></tr></table></figure>
<ul>
<li>repeatUntil:getAsBoolean 如果返回 true则不repeat false则repeat.主要用于动态控制</li>
</ul>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Observable.just(<span class="string">"Love"</span>, <span class="string">"For"</span>, <span class="string">"You!"</span>)</div><div class="line">                .repeatUntil(<span class="keyword">new</span> BooleanSupplier() &#123;</div><div class="line">                    @Override</div><div class="line">                    <span class="keyword">public</span> <span class="keyword">boolean</span> getAsBoolean() <span class="keyword">throws</span> Exception &#123;</div><div class="line">                        System.out.<span class="keyword">println</span>(<span class="string">"getAsBoolean"</span>);</div><div class="line">                        <span class="keyword">count</span>++;</div><div class="line">                        <span class="keyword">if</span> (<span class="keyword">count</span> == <span class="number">3</span>)</div><div class="line">                            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                        <span class="keyword">else</span></div><div class="line">                            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;).subscribe(s -&gt; System.out.<span class="keyword">println</span>(s));</div></pre></td></tr></table></figure>
<ul>
<li>delay:延迟一段指定的时间再发射来自Observable的发射物<blockquote>
<p>注意：<br>delay 不会平移 onError 通知，它会立即将这个通知传递给订阅者，同时丢弃任何待 发射的 onNext 通知。<br>然而它会平移一个 onCompleted 通知</p>
</blockquote>
</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Observable.range(<span class="number">0</span>, <span class="number">3</span>)</div><div class="line">          .delay(<span class="number">1400</span>, TimeUnit.MILLISECONDS)</div><div class="line">          .subscribe(o -&gt; System.out.println(<span class="string">"===&gt;"</span> + o + <span class="string">"<span class="subst">\t</span>"</span>));</div></pre></td></tr></table></figure>
<ul>
<li>delaySubscription:让你你可以延迟订阅原始Observable</li>
</ul>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Observable.just(<span class="number">1</span>)</div><div class="line">                .delaySubscription(<span class="number">2000</span>, TimeUnit.MILLISECONDS)</div><div class="line">                .subscribe(o<span class="function"> -&gt;</span> System.out.println(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>)</div><div class="line">                        , throwable<span class="function"> -&gt;</span> System.out.println(<span class="string">"===&gt;throwable"</span>)</div><div class="line">                        , <span class="function"><span class="params">()</span> -&gt;</span> System.out.println(<span class="string">"===&gt;complete"</span>)</div><div class="line">                        , disposable<span class="function"> -&gt;</span> System.out.println(<span class="string">"===&gt;订阅"</span>));</div></pre></td></tr></table></figure>
<ul>
<li><p>do系列</p>
<ul>
<li><p>doOnEach:注册一个回调，它产生的Observable每发射一项数据就会调用它一次</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Observable.range(0, 3)</div><div class="line">              .doOnEach(<span class="built_in">integer</span>Notification -&gt; System.out.println(<span class="built_in">integer</span>Notification.getValue()))</div><div class="line">              .subscribe(o -&gt; System.out.print(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>));</div><div class="line">  日志:</div><div class="line">  <span class="keyword">do</span>OnEach:</div><div class="line">  <span class="keyword">do</span>OnEach:0===&gt;0</div><div class="line">  <span class="keyword">do</span>OnEach:1===&gt;1</div><div class="line">  <span class="keyword">do</span>OnEach:2===&gt;2</div><div class="line">  <span class="keyword">do</span>OnEach:null</div></pre></td></tr></table></figure>
</li>
<li><p>doOnNext:注类似doOnEach 不是接受一个 Notification 参数，而是接受发射的数据项。</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"> Observable.range(<span class="number">0</span>, <span class="number">3</span>)</div><div class="line">         .doOnNext(integer -&gt; &#123;</div><div class="line">             <span class="keyword">if</span> (integer == <span class="number">2</span>)</div><div class="line">                 <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">"O__O"</span>);</div><div class="line">             System.out.<span class="built_in">print</span>(integer);</div><div class="line">         &#125;)</div><div class="line">         .subscribe(o -&gt; System.out.<span class="built_in">print</span>(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>)</div><div class="line">                 , throwable -&gt; System.out.<span class="built_in">print</span>(<span class="string">"===&gt;throwable"</span>)</div><div class="line">                 , <span class="function"><span class="params">()</span> -&gt;</span> System.out.<span class="built_in">print</span>(<span class="string">"===&gt;complete"</span>));</div><div class="line">日志:</div><div class="line"><span class="number">0</span>==<span class="function">=&gt;</span><span class="number">0</span>	<span class="number">1</span>==<span class="function">=&gt;</span><span class="number">1</span>	==<span class="function">=&gt;</span>throwable</div></pre></td></tr></table></figure>
</li>
<li><p>doOnSubscribe:注册一个动作，在观察者订阅时使用</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Observable.range(<span class="number">0</span>, <span class="number">3</span>)</div><div class="line">              .doOnSubscribe(disposable -&gt; System.out.<span class="built_in">print</span>(<span class="string">"开始订阅"</span>))</div><div class="line">              .subscribe(o -&gt; System.out.<span class="built_in">print</span>(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>));</div><div class="line">    日志:</div><div class="line">     开始订阅==<span class="function">=&gt;</span><span class="number">0</span>	==<span class="function">=&gt;</span><span class="number">1</span>	==<span class="function">=&gt;</span><span class="number">2</span></div></pre></td></tr></table></figure>
</li>
<li><p>doOnComplete:注册一个动作，在观察者OnComplete时使用</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Observable.range(<span class="number">0</span>, <span class="number">3</span>)</div><div class="line">               .doOnComplete<span class="function"><span class="params">(() -&gt; System.out.<span class="built_in">print</span>(<span class="string">"doOnComplete"</span>))</span></span></div><div class="line">               .<span class="title">subscribe</span><span class="params">(o -&gt; System.out.<span class="built_in">print</span>(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>))</span>;</div><div class="line">   日志:</div><div class="line">    ===&gt;0	===&gt;1	===&gt;2	<span class="title">doOnComplete</span></div></pre></td></tr></table></figure>
</li>
<li><p>doOnError:注册一个动作，在观察者doOnError时使用</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Observable.<span class="built_in">error</span>(<span class="keyword">new</span> Throwable(<span class="string">"?"</span>))</div><div class="line">               .doOnError(throwable -&gt; <span class="keyword">System</span>.out.<span class="keyword">print</span>(<span class="string">"throwable"</span>))</div><div class="line">               .subscribe(o -&gt; <span class="keyword">System</span>.out.<span class="keyword">print</span>(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>));</div><div class="line">  日志:</div><div class="line">  异常信息....</div><div class="line">  throwable</div></pre></td></tr></table></figure>
</li>
<li><p>doOnTerminate:注册一个动作，Observable终止之前会被调用，无论是正 常还是异常终止。</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"> Observable.range(<span class="number">0</span>, <span class="number">3</span>)</div><div class="line">         .doOnTerminate<span class="function"><span class="params">(() -&gt; System.out.<span class="built_in">print</span>(<span class="string">"\t doOnTerminate"</span>))</span></span></div><div class="line">         .<span class="title">subscribe</span><span class="params">(o -&gt; System.out.<span class="built_in">print</span>(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>))</span>;</div><div class="line">日志:</div><div class="line">===&gt;0	===&gt;1	===&gt;2		 <span class="title">doOnTerminate</span></div></pre></td></tr></table></figure>
</li>
<li><p>doFinally:注册一个动作,当它产生的Observable终止之后会被调用，无论是正常还 是异常终止。在doOnTerminate之后执行</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Observable.range(<span class="number">0</span>, <span class="number">3</span>)</div><div class="line">                .doFinally<span class="function"><span class="params">(() -&gt; System.out.<span class="built_in">print</span>(<span class="string">"\t doFinally"</span>))</span></span></div><div class="line">                .<span class="title">doOnTerminate</span><span class="params">(() -&gt; System.out.<span class="built_in">print</span>(<span class="string">"\t  doOnTerminate"</span>))</span></div><div class="line">                .<span class="title">subscribe</span><span class="params">(o -&gt; System.out.<span class="built_in">print</span>(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>))</span>;</div><div class="line"> 日志:</div><div class="line"> ===&gt;0	===&gt;1	===&gt;2		  <span class="title">doOnTerminate</span>	 <span class="title">doFinally</span></div></pre></td></tr></table></figure>
</li>
<li><p>doOnDispose:注册一个动作,当【观察者取消】订阅它生成的Observable它就会被调</p>
<blockquote>
<p>注意:貌似需要在 为出现complete和error的时候 dispose才会触发 ~</p>
</blockquote>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Disposable ab = Observable.interval(<span class="number">1</span>, TimeUnit.SECONDS)</div><div class="line">              .take(<span class="number">3</span>)</div><div class="line">              .doOnDispose<span class="function"><span class="params">(() -&gt; System.out.println(<span class="string">"解除订阅"</span>))</span></span></div><div class="line">              .<span class="title">subscribe</span><span class="params">(o -&gt; System.out.<span class="built_in">print</span>(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>))</span>;</div><div class="line">      <span class="title">ab</span>.<span class="title">dispose</span><span class="params">()</span>;</div><div class="line">日志:</div><div class="line">解除订阅</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>materialize:将数据项和事件通知都当做数据项发射</p>
</li>
<li>dematerialize:materialize相反</li>
</ul>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.range</span>(<span class="number">0</span>, <span class="number">3</span>)</div><div class="line">                <span class="comment">//将Observable转换成一个通知列表。</span></div><div class="line">                <span class="selector-class">.materialize</span>()</div><div class="line">                <span class="comment">//与上面的作用相反，将通知逆转回一个Observable</span></div><div class="line">                <span class="selector-class">.dematerialize</span>()</div><div class="line">                <span class="selector-class">.subscribe</span>(o -&gt; System.out.print(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>));</div></pre></td></tr></table></figure>
<ul>
<li>observeOn:指定一个观察者在哪个调度器上观察这个Observable</li>
<li>subscribeOn:指定Observable自身在哪个调度器上执行</li>
</ul>
<blockquote>
<p>注意 遇到错误 会立即处理而不是等待下游还没观察的数据<br>既onError 通知会跳到(并吞掉)原始Observable发射的数据项前面</p>
</blockquote>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Observable.range(<span class="number">0</span>, <span class="number">3</span>)</div><div class="line">              .subscribeOn(Schedulers.<span class="keyword">new</span><span class="type">Thread</span>())</div><div class="line">              .observeOn(Schedulers.<span class="keyword">new</span><span class="type">Thread</span>())</div><div class="line">              .subscribe(o -&gt; System.out.print(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>));</div></pre></td></tr></table></figure>
<ul>
<li><p>subscribe:操作来自Observable的发射物和通知</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Javadoc: </span><span class="keyword">subscribe()</span></div><div class="line"><span class="keyword">Javadoc: </span><span class="keyword">subscribe(onNext)</span></div><div class="line"><span class="keyword">Javadoc: </span><span class="keyword">subscribe(onNext,onError)</span></div><div class="line"><span class="keyword">Javadoc: </span><span class="keyword">subscribe(onNext,onError,onComplete)</span></div><div class="line"><span class="keyword">Javadoc: </span><span class="keyword">subscribe(onNext,onError,onComplete,onSubscribe)</span></div><div class="line"><span class="keyword">Javadoc: </span><span class="keyword">subscribe(Observer)</span></div><div class="line"><span class="keyword">Javadoc: </span><span class="keyword">subscribe(Subscriber)</span></div></pre></td></tr></table></figure>
</li>
<li><p>foreach:forEach 方法是简化版的 subscribe ，你同样可以传递一到三个函数给它，解释和传递给 subscribe 时一样</p>
</li>
</ul>
<blockquote>
<p>不同的是，你无法使用 forEach 返回的对象取消订阅。也没办法传递一个可以用于取消订阅 的参数</p>
</blockquote>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Observable.range(<span class="number">0</span>, <span class="number">3</span>)</div><div class="line">        <span class="comment">//subscribe的简化版本  没啥用</span></div><div class="line">        .forEach(o -&gt; System.out.println(<span class="string">"===&gt;"</span> + o + <span class="string">"<span class="subst">\t</span>"</span>));</div></pre></td></tr></table></figure>
<ul>
<li><p>serialize:保证上游下游同一线程 ，防止不同线程下 onError 通知会跳到(并吞掉)原始Observable发射的数据项前面的错误行为</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.range</span>(<span class="number">0</span>, <span class="number">3</span>)</div><div class="line">           <span class="selector-class">.serialize</span>()</div><div class="line">           <span class="selector-class">.subscribe</span>(o -&gt; System.out.print(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>));</div></pre></td></tr></table></figure>
</li>
<li><p>Timestamp:它将一个发射T类型数据的Observable转换为一个发射类型 为Timestamped<t> 的数据的Observable，每一项都包含数据的原始发射时间</t></p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="type">Observable</span>.interval(<span class="number">100</span>, <span class="type">TimeUnit</span>.<span class="type">MILLISECONDS</span>)</div><div class="line">               .take(<span class="number">3</span>)</div><div class="line">                .timestamp<span class="literal">()</span></div><div class="line">                .subscribe(o -&gt; <span class="type">System</span>.out.println(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>)</div><div class="line">                        , throwable -&gt; <span class="type">System</span>.out.println(<span class="string">"===&gt; throwable"</span>)</div><div class="line">                        , <span class="literal">()</span> -&gt; <span class="type">System</span>.out.println(<span class="string">"===&gt; complete"</span>)</div><div class="line">                        , disposable -&gt; <span class="type">System</span>.out.println(<span class="string">"===&gt; 订阅"</span>));</div><div class="line">    日志:</div><div class="line">    ===&gt; 订阅</div><div class="line">    ===&gt;<span class="type">Timed</span>[time=<span class="number">1501224256554</span>, <span class="built_in">unit</span>=<span class="type">MILLISECONDS</span>, <span class="keyword">value</span>=<span class="number">0</span>]</div><div class="line">    ===&gt;<span class="type">Timed</span>[time=<span class="number">1501224256651</span>, <span class="built_in">unit</span>=<span class="type">MILLISECONDS</span>, <span class="keyword">value</span>=<span class="number">1</span>]</div><div class="line">    ===&gt;<span class="type">Timed</span>[time=<span class="number">1501224256751</span>, <span class="built_in">unit</span>=<span class="type">MILLISECONDS</span>, <span class="keyword">value</span>=<span class="number">2</span>]</div><div class="line">    ===&gt; complete</div></pre></td></tr></table></figure>
</li>
<li><p>timeInterval:一个发射数据的Observable转换为发射那些数据发射时间间隔的Observable</p>
</li>
</ul>
<figure class="highlight coq"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">        Observable.interval(<span class="number">100</span>, TimeUnit.MILLISECONDS)</div><div class="line">                .take(<span class="number">3</span>)</div><div class="line">//         把发送的数据 转化为  相邻发送数据的时间间隔实体</div><div class="line">                .timeInterval()</div><div class="line">//                .timeInterval(Schedulers.newThread())</div><div class="line">                .subscribe(o -&gt; System.out.println(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>)</div><div class="line">                        , throwable -&gt; System.out.println(<span class="string">"===&gt;throwable"</span>)</div><div class="line">                        , () -&gt; System.out.println(<span class="string">"===&gt;complete"</span>)</div><div class="line">                        , disposable -&gt; System.out.println(<span class="string">"===&gt;订阅"</span>));</div><div class="line">    日志:</div><div class="line">    ===&gt;订阅</div><div class="line">    ===&gt;Timed[<span class="built_in">time</span>=<span class="number">113</span>, unit=MILLISECONDS, value=<span class="number">0</span>]</div><div class="line">    ===&gt;Timed[<span class="built_in">time</span>=<span class="number">102</span>, unit=MILLISECONDS, value=<span class="number">1</span>]</div><div class="line">    ===&gt;Timed[<span class="built_in">time</span>=<span class="number">97</span>, unit=MILLISECONDS, value=<span class="number">2</span>]</div><div class="line">    ===&gt;complete</div></pre></td></tr></table></figure>
<ul>
<li><p>timeout</p>
<ul>
<li><p>变体:过了一个指定的时长仍没有发射数据(不是仅仅考虑第一个)，它会发一个错误</p>
<figure class="highlight coq"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"> Observable.interval(<span class="number">100</span>, TimeUnit.MILLISECONDS)</div><div class="line">//        过了一个指定的时长仍没有发射数据(不是仅仅考虑第一个)，它会发一个错误</div><div class="line">                .<span class="built_in">timeout</span>(<span class="number">50</span>, TimeUnit.MILLISECONDS)</div><div class="line">                .subscribe(o -&gt; System.out.println(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>)</div><div class="line">                        , throwable -&gt; System.out.println(<span class="string">"===&gt;timeout throwable"</span>)</div><div class="line">                        , () -&gt; System.out.println(<span class="string">"===&gt;timeout complete"</span>)</div><div class="line">                        , disposable -&gt; System.out.println(<span class="string">"===&gt;timeout 订阅"</span>));</div><div class="line"><span class="built_in">timeout</span>:</div><div class="line">===&gt;<span class="built_in">timeout</span> 订阅</div><div class="line">===&gt;<span class="built_in">timeout</span> throwable</div></pre></td></tr></table></figure>
</li>
<li><p>变体 备用Observable:过了一个指定的时长仍没有发射数据(不是仅仅考虑第一个)，它会发一个错误</p>
<figure class="highlight coq"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"> Observable&lt;Integer&gt; other;</div><div class="line"> Observable.empty()</div><div class="line">         // 过了一个指定的时长仍没有发射数据(不是仅仅考虑第一个)，他会用备用Observable 发送数据，本身的会发送一个compelte</div><div class="line">         .<span class="built_in">timeout</span>(<span class="number">50</span>, TimeUnit.MILLISECONDS, other = Observable.just(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>))</div><div class="line">         .subscribe(o -&gt; System.out.println(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>)</div><div class="line">                 , throwable -&gt; System.out.println(<span class="string">"===&gt;timeout2 throwable"</span>)</div><div class="line">                 , () -&gt; System.out.println(<span class="string">"===&gt;timeout2 complete"</span>)</div><div class="line">                 , disposable -&gt; System.out.println(<span class="string">"===&gt;timeout2 订阅"</span>));</div><div class="line"> other.subscribe(o -&gt; System.out.println(<span class="string">"k ===&gt;"</span> + o + <span class="string">"\t"</span>));</div><div class="line">timeout2:</div><div class="line">===&gt;timeout2 订阅</div><div class="line">===&gt;timeout2 complete</div><div class="line">k ===&gt;<span class="number">2</span></div><div class="line">k ===&gt;<span class="number">3</span></div><div class="line">k ===&gt;<span class="number">4</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="变换操作"><a href="#变换操作" class="headerlink" title="变换操作"></a>变换操作</h2><ul>
<li>map:对Observable发射的每一项数据应用一个函数，执行变换操作,就是方形过渡到圆形</li>
</ul>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Observable.just(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">              .<span class="function"><span class="title">map</span>(<span class="keyword">integer</span> -&gt;</span> <span class="string">"This is result "</span> + <span class="keyword">integer</span>)</div><div class="line">              .<span class="function"><span class="title">subscribe</span>(s -&gt;</span> System.out.println(s));</div></pre></td></tr></table></figure>
<ul>
<li>flatMap: 将一个发射数据的Observable变换为多个Observables，然后将它们发射的数据合并后放进一个单独的Observable<ul>
<li>mapper:根据发射数据映射成Observable</li>
<li>combiner: 用来合并 的</li>
</ul>
</li>
</ul>
<blockquote>
<p>注意:FlatMap 对这些Observables发射的数据做的是合并( merge )操作，因此它们可能是交 错的。</p>
</blockquote>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">     Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">               .flatMap(integer -&gt; Observable.range(integer * <span class="number">10</span>, <span class="number">2</span>)</div><div class="line">                       , (a, b) -&gt; &#123;</div><div class="line">                           <span class="comment">//a ： 原始数据的 just(1,2,3) 中的值</span></div><div class="line">                           <span class="comment">//b ： 代表 flatMap后合并发送的数据的值</span></div><div class="line">                           System.out.print(<span class="string">"\n a:"</span> + a + <span class="string">"\t b:"</span> + b);</div><div class="line">                           <span class="comment">//return flatMap发送的值 ，经过处理后 而发送的值</span></div><div class="line">                           <span class="keyword">return</span> a + b;</div><div class="line">                       &#125;)</div><div class="line">               .subscribe(s -&gt; System.out.print(<span class="string">"\t"</span>+s));</div><div class="line">日志：</div><div class="line"> &lt;!-- 这里有顺序是因为没有在其他线程执行 --&gt;</div><div class="line"><span class="string">a:</span><span class="number">1</span>	 <span class="string">b:</span><span class="number">10</span>	<span class="number">11</span></div><div class="line"><span class="string">a:</span><span class="number">1</span>	 <span class="string">b:</span><span class="number">11</span>	<span class="number">12</span></div><div class="line"><span class="string">a:</span><span class="number">2</span>	 <span class="string">b:</span><span class="number">20</span>	<span class="number">22</span></div><div class="line"><span class="string">a:</span><span class="number">2</span>	 <span class="string">b:</span><span class="number">21</span>	<span class="number">23</span></div><div class="line"><span class="string">a:</span><span class="number">3</span>	 <span class="string">b:</span><span class="number">30</span>	<span class="number">33</span></div><div class="line"><span class="string">a:</span><span class="number">3</span>	 <span class="string">b:</span><span class="number">31</span>	<span class="number">34</span></div></pre></td></tr></table></figure>
<ul>
<li>concatMap:类似FlatMap但是保证顺序 因为没有合并操作！</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">            .concatMap(<span class="type">integer</span> -&gt; Observable.range(<span class="type">integer</span> * <span class="number">10</span>, <span class="number">2</span>))</div><div class="line">            .subscribe(s -&gt; System.out.print(<span class="string">"<span class="subst">\t</span>"</span>+s));</div></pre></td></tr></table></figure>
<ul>
<li>cast:在发射之前强制将Observable发射的所有数据转换为指定类型</li>
</ul>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="string">"string"</span>)</div><div class="line">               .cast(Integer.class)<span class="comment">//订阅之后才能发横强转</span></div><div class="line">               .<span class="function"><span class="title">subscribe</span>(<span class="keyword">integer</span> -&gt;</span> System.out.println(<span class="keyword">integer</span>)</div><div class="line">                       , <span class="function"><span class="title">throwable</span> -&gt;</span> System.out.println(throwable.getMessage()));</div></pre></td></tr></table></figure>
<ul>
<li>groupBy:通过keySelector的apply的值当做key 进行分组,发射GroupedObservable(有getKey()方法)的group 通过group继续订阅取得其组内的值;<ul>
<li>keySelector:通过这个的返回值 当做key进行分组</li>
<li>valueSelector:value转换</li>
</ul>
</li>
</ul>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">  <span class="type">Observable</span>.range(<span class="number">0</span>, <span class="number">10</span>)</div><div class="line">                .groupBy(integer -&gt; integer % <span class="number">2</span>, integer -&gt; <span class="string">"("</span> + integer + <span class="string">")"</span>)</div><div class="line">                .subscribe(group -&gt; &#123;</div><div class="line">                    group.subscribe(integer -&gt; <span class="type">System</span>.out.println(</div><div class="line">                            <span class="string">"key:"</span> + group.getKey<span class="literal">()</span> + <span class="string">"==&gt;value:"</span> + integer));</div><div class="line">                &#125;);</div><div class="line">日志：</div><div class="line">key:<span class="number">0</span>==&gt;<span class="keyword">value</span>:(<span class="number">0</span>)</div><div class="line">key:<span class="number">1</span>==&gt;<span class="keyword">value</span>:(<span class="number">1</span>)</div><div class="line">key:<span class="number">0</span>==&gt;<span class="keyword">value</span>:(<span class="number">2</span>)</div><div class="line">key:<span class="number">1</span>==&gt;<span class="keyword">value</span>:(<span class="number">3</span>)</div><div class="line">key:<span class="number">0</span>==&gt;<span class="keyword">value</span>:(<span class="number">4</span>)</div><div class="line">key:<span class="number">1</span>==&gt;<span class="keyword">value</span>:(<span class="number">5</span>)</div><div class="line">key:<span class="number">0</span>==&gt;<span class="keyword">value</span>:(<span class="number">6</span>)</div><div class="line">key:<span class="number">1</span>==&gt;<span class="keyword">value</span>:(<span class="number">7</span>)</div><div class="line">key:<span class="number">0</span>==&gt;<span class="keyword">value</span>:(<span class="number">8</span>)</div><div class="line">key:<span class="number">1</span>==&gt;<span class="keyword">value</span>:(<span class="number">9</span>)</div></pre></td></tr></table></figure>
<ul>
<li>window: 依照此范例 每三秒收集,Observable在此时间内发送的值。组装成Observable发送出去。</li>
</ul>
<figure class="highlight moonscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">Observable.interval(<span class="number">1</span>, TimeUnit.SECONDS).take(<span class="number">7</span>)</div><div class="line">                //返回值  Observable&lt;Observable&lt;T&gt;&gt; 即代表 发送Observable&lt;T&gt;</div><div class="line">                .window(<span class="number">3</span>, TimeUnit.SECONDS)</div><div class="line">                .subscribeOn(Schedulers.<span class="built_in">io</span>())</div><div class="line">                .observeOn(Schedulers.<span class="built_in">io</span>())</div><div class="line">                .subscribe(integerObservable -&gt; &#123;</div><div class="line">                    System.out.println(integerObservable);</div><div class="line">                    integerObservable.subscribe(integer -&gt; System.out.println(integerObservable+<span class="string">"===&gt;"</span>+integer));</div><div class="line">                &#125;);</div><div class="line">日志:</div><div class="line">为什么不是 <span class="number">345</span>一起？ 因为会有太细微的时间差。例如<span class="number">5</span>如果在多线程切换的时候是超过<span class="number">3</span>秒的<span class="number">1</span>毫秒则就尴尬了~</div><div class="line"><span class="built_in">io</span>.reactivex.subjects.UnicastSubject@<span class="number">531</span>c3d1c</div><div class="line"><span class="built_in">io</span>.reactivex.subjects.UnicastSubject@<span class="number">531</span>c3d1c==<span class="function">=&gt;</span><span class="number">0</span></div><div class="line"><span class="built_in">io</span>.reactivex.subjects.UnicastSubject@<span class="number">531</span>c3d1c==<span class="function">=&gt;</span><span class="number">1</span></div><div class="line"><span class="built_in">io</span>.reactivex.subjects.UnicastSubject@<span class="number">531</span>c3d1c==<span class="function">=&gt;</span><span class="number">2</span></div><div class="line"><span class="built_in">io</span>.reactivex.subjects.UnicastSubject@<span class="number">2</span>ea0f969</div><div class="line"><span class="built_in">io</span>.reactivex.subjects.UnicastSubject@<span class="number">2</span>ea0f969==<span class="function">=&gt;</span><span class="number">3</span></div><div class="line"><span class="built_in">io</span>.reactivex.subjects.UnicastSubject@<span class="number">2</span>ea0f969==<span class="function">=&gt;</span><span class="number">4</span></div><div class="line"><span class="built_in">io</span>.reactivex.subjects.UnicastSubject@<span class="number">2</span>d30de03</div><div class="line"><span class="built_in">io</span>.reactivex.subjects.UnicastSubject@<span class="number">2</span>d30de03==<span class="function">=&gt;</span><span class="number">5</span></div><div class="line"><span class="built_in">io</span>.reactivex.subjects.UnicastSubject@<span class="number">2</span>d30de03==<span class="function">=&gt;</span><span class="number">6</span></div></pre></td></tr></table></figure>
<ul>
<li>scan:连续地对数据序列的每一项应用一个函数，然后连续发射结果</li>
</ul>
<blockquote>
<p>感觉就是发送一个有 累加(函数) 过程序列</p>
<pre><code>* initialValue（可选） 其实就是放到 原始数据之前发射。
* a 原始数据的中的值
* b 则是最后应用scan函数后发送的值
</code></pre></blockquote>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"> Observable.just(<span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>)</div><div class="line">                <span class="comment">//7是用来 对于第一次的 a的值</span></div><div class="line">                .scan(<span class="number">7</span>, (a, b) -&gt; &#123;</div><div class="line">                    <span class="comment">//b 原始数据的 just(1,4,2) 中的值</span></div><div class="line">                    <span class="comment">//a 则是最后应用scan 发送的值</span></div><div class="line">                    System.out.format(<span class="string">"a:%d * b:%d\n"</span>, a, b);</div><div class="line">                    <span class="keyword">return</span> a * b;</div><div class="line">                &#125;)</div><div class="line">                .subscribe(integer -&gt; System.out.println(<span class="string">"===&gt;："</span>+integer));</div><div class="line">日志：</div><div class="line">===&gt;：<span class="number">7</span></div><div class="line"><span class="string">a:</span><span class="number">7</span> * <span class="string">b:</span><span class="number">1</span></div><div class="line">===&gt;：<span class="number">7</span></div><div class="line"><span class="string">a:</span><span class="number">7</span> * <span class="string">b:</span><span class="number">4</span></div><div class="line">===&gt;：<span class="number">28</span></div><div class="line"><span class="string">a:</span><span class="number">28</span> * <span class="string">b:</span><span class="number">2</span></div><div class="line">===&gt;：<span class="number">56</span></div></pre></td></tr></table></figure>
<ul>
<li><p>buffer系列</p>
<ul>
<li><p>变体 count系列</p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">* 范例:发射<span class="string">[1-10]</span></div><div class="line">* buffer count <span class="number">2</span> skip <span class="number">1</span>,结果 <span class="string">[1,2]</span>  <span class="string">[2,3]</span> <span class="string">[3,4]</span> <span class="number">3</span>=<span class="number">2</span>*<span class="number">1</span>+<span class="number">1</span></div><div class="line">* buffer count <span class="number">2</span> skip <span class="number">2</span>,结果 <span class="string">[1,2]</span>  <span class="string">[3,4]</span> <span class="string">[5,6]</span> <span class="number">5</span>=<span class="number">2</span>*<span class="number">2</span>+<span class="number">1</span></div><div class="line">* buffer count <span class="number">2</span> skip <span class="number">3</span>,结果 <span class="string">[1,2]</span>  <span class="string">[4,5]</span> <span class="string">[7,8]</span> <span class="number">7</span>=<span class="number">2</span>*<span class="number">3</span>+<span class="number">1</span>;</div></pre></td></tr></table></figure>
<ul>
<li>count:缓存的数量</li>
<li><p>skip:每个缓存创建的间隔数量</p>
<blockquote>
<p>则代表 每次初始偏移量 每次真正的起始值=fistValue+skip*skipCount;<br>注意skip不能小于0<br>可以小于count这样就会导致每个发送的list之间的值会有重复<br>可以大于count这样就会导致每个发送的list之间的值和原有的值之间会有遗漏<br>可以等于count就你懂的了</p>
</blockquote>
</li>
<li><p>bufferSupplier:自定义缓存装载的容器；</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Observable.range(1, 10)</div><div class="line">        .buffer(2, 1,() -&gt; new ArrayList<span class="tag">&lt;&gt;</span>())//有默认的装载器</div><div class="line">        <span class="comment">&lt;!-- 其他方法 --&gt;</span></div><div class="line">        <span class="comment">&lt;!-- .buffer(2)//skip 默认和count一样 --&gt;</span></div><div class="line">        <span class="comment">&lt;!--  .buffer(2, () -&gt; new ArrayList&lt;&gt;())--&gt;</span></div><div class="line">        .subscribe(integers -&gt; System.out.println(integers));</div><div class="line"></div><div class="line"> 解析:每发射1个。创建一个发射物list buffer,每个buffer缓存2个,收集的存入list后发送。</div></pre></td></tr></table></figure>
</li>
<li><p>变体 time系列</p>
<ul>
<li>timespan:缓存的时间</li>
<li>timeskip:每个缓存创建的间隔时间  同skip 可以小于大于等于timespan</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">  <span class="selector-tag">Observable</span><span class="selector-class">.interval</span>(500, <span class="selector-tag">TimeUnit</span><span class="selector-class">.MILLISECONDS</span>)<span class="selector-class">.take</span>(7)</div><div class="line">                <span class="selector-class">.buffer</span>(3, 2, <span class="selector-tag">TimeUnit</span><span class="selector-class">.SECONDS</span>, <span class="selector-tag">Schedulers</span><span class="selector-class">.single</span>(),</div><div class="line">                        <span class="selector-tag">Functions</span><span class="selector-class">.createArrayList</span>(16))</div><div class="line">                <span class="selector-class">.subscribe</span>(<span class="selector-tag">integers</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="selector-tag">integers</span>));</div><div class="line"></div><div class="line">解析:每两秒创建一个发射物<span class="selector-tag">list</span> <span class="selector-tag">buffer</span>,每个<span class="selector-tag">buffer</span>缓存三秒 收集的存入<span class="selector-tag">list</span>后发送。</div><div class="line">日志:</div><div class="line">  <span class="selector-attr">[0, 1, 2, 3, 4]</span></div><div class="line">  <span class="selector-attr">[4, 5, 6]</span></div></pre></td></tr></table></figure>
<ul>
<li>变体 自定义buffer创建和收集时间</li>
<li>bufferOpenings:每当 bufferOpenings 发射了一个数据时，它就 创建一个新的 List,开始装入之后的发射数据</li>
<li>closingSelector:每当 closingSelector 发射了一个数据时,就结束装填数据 发射List。<figure class="highlight xl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">    &lt;!-- 范例和<span class="function"><span class="title">time</span>系列的就一样了 --&gt;</span></div><div class="line"> C<span class="function"><span class="title">onsumer</span>&lt;Long&gt; longConsumer = aLong -&gt;</span> System.out.println(<span class="string">"开始创建 bufferSupplier"</span>);</div><div class="line">        C<span class="function"><span class="title">onsumer</span>&lt;Long&gt; longConsumer2 = aLong -&gt;</span> System.out.println(<span class="string">"结束收集"</span>);</div><div class="line">        Observable.interval(<span class="number">500</span>, TimeUnit.MILLISECONDS).take(<span class="number">7</span>)</div><div class="line"><span class="comment">//                .doOnNext(aLong -&gt; System.out.println("原始发射物：" + aLong))</span></div><div class="line">                .buffer(Observable.interval(<span class="number">2</span>, TimeUnit.SECONDS)</div><div class="line">                                .startWith(-<span class="number">1</span>L)<span class="comment">//为了刚开始就发射一次</span></div><div class="line">                                .take(<span class="number">2</span>)<span class="comment">//多余的我就不创建了</span></div><div class="line">                                .doOnNext(longConsumer)</div><div class="line">                        , <span class="function"><span class="title">aLong</span> -&gt;</span> Observable.timer(<span class="number">3</span>, TimeUnit.SECONDS)</div><div class="line">                                .doOnNext(longConsumer2)</div><div class="line">                        , () -&gt; new ArrayList&lt;&gt;())</div><div class="line">                .<span class="function"><span class="title">subscribe</span>(integers -&gt;</span> System.out.println(<span class="string">"buffer发射物"</span> + integers));</div><div class="line"></div><div class="line">日志:</div><div class="line">openings:</div><div class="line">开始创建 bufferSupplier</div><div class="line">开始创建 bufferSupplier</div><div class="line">结束收集</div><div class="line">buffer发射物[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</div><div class="line">buffer发射物[<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>变体 仅仅bufer创建时间</p>
<ul>
<li>boundarySupplier 因为发送一个值代表上个缓存的发送 和这个缓存的创建</li>
</ul>
<blockquote>
<p>这个缓存是连续的, 因为发送一个值代表上个缓存的发送 和这个缓存的创建<br>有发射物的时候 没缓存就创建了 就是 默认第一个发射物的时候由内部创建<br>注意 如果不发送事件缓存 存满了 会自动发送出去的</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.interval</span>(500, <span class="selector-tag">TimeUnit</span><span class="selector-class">.MILLISECONDS</span>)<span class="selector-class">.take</span>(7)</div><div class="line">                <span class="selector-class">.buffer</span>(() <span class="selector-tag">-</span>&gt; <span class="selector-tag">Observable</span><span class="selector-class">.timer</span>(2, <span class="selector-tag">TimeUnit</span><span class="selector-class">.SECONDS</span>)</div><div class="line">                                <span class="selector-class">.doOnNext</span>(<span class="selector-tag">aLong</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.println</span>("开始创建 <span class="selector-tag">bufferSupplier</span>"))</div><div class="line">                        , () <span class="selector-tag">-</span>&gt; <span class="selector-tag">new</span> <span class="selector-tag">ArrayList</span>&lt;<span class="selector-tag">Object</span>&gt;())</div><div class="line">                <span class="selector-class">.subscribe</span>(<span class="selector-tag">integers</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="selector-tag">integers</span>));</div><div class="line">日志:</div><div class="line">开始创建 <span class="selector-tag">bufferSupplier</span></div><div class="line"><span class="selector-attr">[0, 1, 2]</span></div><div class="line"><span class="selector-attr">[3, 4, 5, 6]</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="合并操作符"><a href="#合并操作符" class="headerlink" title="合并操作符"></a>合并操作符</h2><ul>
<li>zip(静态方法):只有当原始的Observable中的每一个都发射了 一条数据时 zip 才发射数据。接受一到九个参数</li>
</ul>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">Observable&lt;Long&gt; observable1 = Observable.interval(<span class="number">100</span>, TimeUnit.MILLISECONDS)</div><div class="line">                .take(<span class="number">3</span>)</div><div class="line">                .subscribeOn(Schedulers.newThread());</div><div class="line">        Observable&lt;Long&gt; observable2 = Observable.interval(<span class="number">200</span>, TimeUnit.MILLISECONDS)</div><div class="line">                .take(<span class="number">4</span>)</div><div class="line">                .subscribeOn(Schedulers.newThread());</div><div class="line">        Observable.zip<span class="function"><span class="params">(observable1, observable2, (aLong, aLong2) -&gt; &#123;</span></span></div><div class="line">            System.out.<span class="built_in">print</span>(<span class="string">"aLong:"</span> + aLong + <span class="string">"\t aLong2:"</span> + aLong2+<span class="string">"\t"</span>);</div><div class="line">            <span class="keyword">return</span> aLong + aLong2;</div><div class="line">        &#125;).<span class="title">subscribe</span><span class="params">(o -&gt; System.out.println(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>))</span>;</div><div class="line"></div><div class="line">日志:</div><div class="line"><span class="title">aLong</span>:0	 <span class="title">aLong2</span>:0===&gt;0</div><div class="line"><span class="title">aLong</span>:1	 <span class="title">aLong2</span>:1===&gt;2</div><div class="line"><span class="title">aLong</span>:2	 <span class="title">aLong2</span>:2===&gt;4</div></pre></td></tr></table></figure>
<ul>
<li>zipWith:zip的非静态写法,总是接受两个参数，第一个参数是一个Observable或者一个Iterable。</li>
</ul>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">observable1.zipWith<span class="function"><span class="params">( observable2, (aLong, aLong2) -&gt; &#123;</span></span></div><div class="line">    System.out.<span class="built_in">print</span>(<span class="string">"aLong:"</span> + aLong + <span class="string">"\t aLong2:"</span> + aLong2+<span class="string">"\t"</span>);</div><div class="line">    <span class="keyword">return</span> aLong + aLong2;</div><div class="line">&#125;).<span class="title">subscribe</span><span class="params">(o -&gt; System.out.println(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>))</span>;</div></pre></td></tr></table></figure>
<ul>
<li>merge(静态方法):根据时间线 合并多个observer</li>
</ul>
<figure class="highlight golo"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">Observable</span>&lt;Long&gt; ob1 = <span class="keyword">Observable</span>.interval(<span class="number">100</span>, TimeUnit.MILLISECONDS)</div><div class="line">                .take(<span class="number">3</span>)</div><div class="line">                .subscribeOn(Schedulers.newThread());</div><div class="line"></div><div class="line">        <span class="keyword">Observable</span>&lt;Long&gt; ob2 = <span class="keyword">Observable</span>.interval(<span class="number">50</span>, TimeUnit.MILLISECONDS)</div><div class="line">                .take(<span class="number">3</span>)</div><div class="line">                .<span class="keyword">map</span>(aLong -&gt; aLong + <span class="number">10</span>)</div><div class="line">                .subscribeOn(Schedulers.newThread());</div><div class="line">        <span class="keyword">Observable</span>.merge(ob1, ob2)</div><div class="line">                .subscribe(o -&gt; System.out.<span class="keyword">print</span>(o + <span class="string">"\t"</span>));</div><div class="line">日志结果:可以见出是根据时间线合并</div><div class="line"><span class="number">10</span>	<span class="number">10</span>	<span class="number">0</span>	<span class="number">0</span>	<span class="number">11</span>	<span class="number">11</span>	<span class="number">12</span>	<span class="number">12</span>	<span class="number">1</span>	<span class="number">1</span>	<span class="number">2</span>	<span class="number">2</span></div></pre></td></tr></table></figure>
<ul>
<li>mergeWith:merge非静态写法</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">ob1</span><span class="selector-class">.mergeWith</span>(<span class="selector-tag">ob2</span>)</div><div class="line">               <span class="selector-class">.subscribe</span>(<span class="selector-tag">o</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.print</span>( <span class="selector-tag">o</span> + "\<span class="selector-tag">t</span>"));</div></pre></td></tr></table></figure>
<ul>
<li>combineLatest(静态方法):使用一个函数结合它们最近发射的数据，然后发射这个函数的返回值,它接受二到九个Observable作为参数 或者单 个Observables列表作为参数</li>
</ul>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">Observable&lt;Long&gt; observable1 = Observable.interval(<span class="number">100</span>, TimeUnit.MILLISECONDS)</div><div class="line">              .take(<span class="number">4</span>)</div><div class="line">              .subscribeOn(Schedulers.newThread());</div><div class="line">      Observable&lt;Long&gt; observable2 = Observable.interval(<span class="number">200</span>, TimeUnit.MILLISECONDS)</div><div class="line">              .take(<span class="number">5</span>)</div><div class="line">              .subscribeOn(Schedulers.newThread());</div><div class="line">      Observable.combineLatest(observable1, observable2, <span class="function"><span class="params">(aLong, aLong2)</span> -&gt;</span> &#123;</div><div class="line">          System.out.<span class="built_in">print</span>(<span class="string">"aLong:"</span> + aLong + <span class="string">"\t aLong2:"</span> + aLong2+<span class="string">"\t"</span>);</div><div class="line">          <span class="keyword">return</span> aLong + aLong2;</div><div class="line">      &#125;).subscribe(o -&gt; System.out.println(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>));</div><div class="line">  日志:</div><div class="line">  aLong:<span class="number">1</span>	 aLong2:<span class="number">0</span>	==<span class="function">=&gt;</span><span class="number">1</span></div><div class="line">  aLong:<span class="number">2</span>	 aLong2:<span class="number">0</span>	==<span class="function">=&gt;</span><span class="number">2</span></div><div class="line">  aLong:<span class="number">3</span>	 aLong2:<span class="number">0</span>	==<span class="function">=&gt;</span><span class="number">3</span></div><div class="line">  aLong:<span class="number">3</span>	 aLong2:<span class="number">1</span>	==<span class="function">=&gt;</span><span class="number">4</span></div><div class="line">  aLong:<span class="number">3</span>	 aLong2:<span class="number">2</span>	==<span class="function">=&gt;</span><span class="number">5</span></div><div class="line">  aLong:<span class="number">3</span>	 aLong2:<span class="number">3</span>	==<span class="function">=&gt;</span><span class="number">6</span></div><div class="line">  aLong:<span class="number">3</span>	 aLong2:<span class="number">4</span>	==<span class="function">=&gt;</span><span class="number">7</span></div></pre></td></tr></table></figure>
<ul>
<li>withLatestFrom:类似zip ,但是只在单个原始Observable发射了一条数据时才发射数据,而不是两个都发</li>
</ul>
<blockquote>
<p>但是注意 如果没有合并元素 既辅助Observable一次都没发射的时候 是不发射数据的</p>
</blockquote>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">       Observable&lt;Long&gt; observable2 = Observable.interval(<span class="number">150</span>, TimeUnit.MILLISECONDS)</div><div class="line">                .take(<span class="number">4</span>)</div><div class="line">                .subscribeOn(Schedulers.newThread());</div><div class="line">        Observable.interval(<span class="number">100</span>, TimeUnit.MILLISECONDS)</div><div class="line">                .take(<span class="number">3</span>)</div><div class="line">                .subscribeOn(Schedulers.newThread())</div><div class="line">                .withLatestFrom<span class="function"><span class="params">(observable2, (aLong, aLong2) -&gt; &#123;</span></span></div><div class="line">                    System.out.<span class="built_in">print</span>(<span class="string">"aLong:"</span> + aLong + <span class="string">"\t aLong2:"</span> + aLong2 + <span class="string">"\t"</span>);</div><div class="line">                    <span class="keyword">return</span> aLong + aLong2;</div><div class="line">                &#125;)</div><div class="line">                .<span class="title">subscribe</span><span class="params">(o -&gt; System.out.println(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>))</span>;</div><div class="line"></div><div class="line">日志:</div><div class="line">明明原始<span class="title">take</span>是3为啥不是三条<span class="title">log</span>呢 因为原始的发送0的时候 ，辅助<span class="title">Observable</span>还没发送过数据</div><div class="line"><span class="title">aLong</span>:1	 <span class="title">aLong2</span>:0	===&gt;1</div><div class="line"><span class="title">aLong</span>:2	 <span class="title">aLong2</span>:1	===&gt;3</div></pre></td></tr></table></figure>
<ul>
<li>switchMap:和flatMap类似,不同的是当原始Observable发射一个新的数据（Observable）时，它将取消订阅前一个Observable</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">        Observable.interval(<span class="number">500</span>, TimeUnit.MILLISECONDS)</div><div class="line">                .take(<span class="number">3</span>)</div><div class="line">                .doOnNext(aLong -&gt; System.out.println())</div><div class="line">                .switchMap(aLong -&gt; Observable.intervalRange(aLong * <span class="number">10</span>, <span class="number">3</span>,</div><div class="line">                        <span class="number">0</span>, <span class="number">300</span>, TimeUnit.MILLISECONDS)</div><div class="line">                        .subscribeOn(Schedulers.newThread()))</div><div class="line">                .subscribe(aLong -&gt; System.out.print(aLong+<span class="string">"<span class="subst">\t</span>"</span>));</div><div class="line">解析：因为发送<span class="number">2</span>的时候 intervalRange发送第三条数据的时候已经是<span class="number">600</span>ms既 <span class="number">500</span>ms的时候原始数据发送了。导致取消订阅前一个Observable</div><div class="line">所以 <span class="number">2</span> ,<span class="number">12</span>没有发送 但是最后的<span class="number">22</span>发送了 因为原始数据没有新发送的了</div><div class="line"></div><div class="line"><span class="comment">//        日志结果</span></div><div class="line"><span class="comment">//        0	1</span></div><div class="line"><span class="comment">//        10	11</span></div><div class="line"><span class="comment">//        20	21	22</span></div><div class="line"><span class="comment">//        而不是</span></div><div class="line"><span class="comment">//        0     1   2</span></div><div class="line"><span class="comment">//        10	11  12</span></div><div class="line"><span class="comment">//        20	21  22</span></div></pre></td></tr></table></figure>
<ul>
<li>startWith:是concat()的对应部分,在Observable开始发射他们的数据之前,startWith()通过传递一个参数来先发射一个数据序列</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">   Observable.just("old")</div><div class="line">                  <span class="comment">&lt;!-- 简化版本 T item  --&gt;</span></div><div class="line">                  .startWith("Start")</div><div class="line">                  <span class="comment">&lt;!--  多次应用探究 --&gt;</span></div><div class="line">                  .startWith("Start2")</div><div class="line">                  <span class="comment">&lt;!--  observer --&gt;</span></div><div class="line">                  .startWith(Observable.just("Other Observable"))</div><div class="line">                   <span class="comment">&lt;!--  Iterable --&gt;</span></div><div class="line">                  .startWith(Arrays.asList("from Iterable"))</div><div class="line">                   <span class="comment">&lt;!--  T... --&gt;</span></div><div class="line">                  .startWithArray("from Array", "from Array2")</div><div class="line">                  .subscribe(s -&gt; System.out.println(s));</div><div class="line">日志:</div><div class="line">from Array</div><div class="line">from Array2</div><div class="line">from Iterable</div><div class="line">Other Observable</div><div class="line">Start2</div><div class="line">Start</div><div class="line">old</div></pre></td></tr></table></figure>
<ul>
<li>join:任何时候，只要在另一个Observable发射的数据定义的时间窗口内，这个Observable发射了。一条数据，就结合两个Observable发射的数据</li>
</ul>
<p><img src="https://ww3.sinaimg.cn/large/006tKfTcgy1fhzely2zzjj31am0r2go8.jpg" alt=""></p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;!-- 此demo 好使但是未让能理解透彻  仅仅想测试能结果的任用  想明白的话 此demo无效<span class="function"> --&gt;</span></div><div class="line">Observable.intervalRange(<span class="number">10</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">300</span>, TimeUnit.MILLISECONDS)</div><div class="line">           .join(Observable.interval(<span class="number">100</span>, TimeUnit.MILLISECONDS)</div><div class="line">                           .take(<span class="number">7</span>)</div><div class="line">                   , aLong<span class="function"> -&gt;</span> &#123;</div><div class="line">                       System.out.println(<span class="string">"开始收集："</span>+aLong);</div><div class="line">                       <span class="keyword">return</span> Observable.just(aLong);</div><div class="line">                   &#125;</div><div class="line">                   , aLong<span class="function"> -&gt;</span> Observable.timer(<span class="number">200</span>, TimeUnit.MILLISECONDS)</div><div class="line">                   , <span class="function"><span class="params">(aLong, aLong2)</span> -&gt;</span> &#123;</div><div class="line">                       System.out.<span class="built_in">print</span>(<span class="string">"aLong:"</span> + aLong + <span class="string">"\t aLong2:"</span> + aLong2 + <span class="string">"\t"</span>);</div><div class="line">                       <span class="keyword">return</span> aLong + aLong2;</div><div class="line">                   &#125;</div><div class="line">           )</div><div class="line">           .subscribe(aLong<span class="function"> -&gt;</span> System.out.println(aLong));</div></pre></td></tr></table></figure>
<h2 id="条件操作"><a href="#条件操作" class="headerlink" title="条件操作"></a>条件操作</h2><ul>
<li><p>all:判定是否Observable发射的所有数据都满足某个条件</p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> Observable.just(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</div><div class="line">                .<span class="function"><span class="title">all</span>(<span class="keyword">integer</span> -&gt;</span> <span class="keyword">integer</span> &gt; <span class="number">3</span>)</div><div class="line">                .<span class="function"><span class="title">subscribe</span>((aBoolean, throwable) -&gt;</span> System.out.println(aBoolean));</div><div class="line">日志：<span class="literal">false</span></div></pre></td></tr></table></figure>
</li>
<li><p>amb:给定多个Observable，只让第一个发射数据的Observable发射全部数据</p>
<ul>
<li><p>ambArray(静态方法):根据测试结果这个静态方法发射的最后一个</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">  Observable.ambArray(</div><div class="line">            Observable.intervalRange(<span class="number">0</span>, <span class="number">3</span>, <span class="number">200</span>, <span class="number">100</span>, TimeUnit.MILLISECONDS)</div><div class="line">            , Observable.intervalRange(<span class="number">10</span>, <span class="number">3</span>, <span class="number">300</span>, <span class="number">100</span>, TimeUnit.MILLISECONDS)</div><div class="line">            , Observable.intervalRange(<span class="number">20</span>, <span class="number">3</span>, <span class="number">100</span>, <span class="number">100</span>, TimeUnit.MILLISECONDS)</div><div class="line">    )</div><div class="line">            .doOnComplete(() -&gt; System.out.println(<span class="string">"Complete"</span>))</div><div class="line">            .subscribe(aLong -&gt; System.out.println(aLong));</div><div class="line">日志：</div><div class="line"><span class="number">20</span>  <span class="number">21</span>  <span class="number">22</span>  Complete</div></pre></td></tr></table></figure>
</li>
<li><p>ambWith:这个发射原始的</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> Observable.intervalRange(<span class="number">0</span>, <span class="number">3</span>, <span class="number">200</span>, <span class="number">100</span>, TimeUnit.MILLISECONDS)</div><div class="line">                .ambWith(Observable.intervalRange(<span class="number">10</span>, <span class="number">3</span>, <span class="number">300</span>, <span class="number">100</span>, TimeUnit.MILLISECONDS))</div><div class="line">                .doOnComplete(() -&gt; System.out.println(<span class="string">"Complete"</span>))</div><div class="line">                .subscribe(aLong -&gt; System.out.println(aLong));</div><div class="line">日志：</div><div class="line"><span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   Complete</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>contains:判定一个Observable是否发射一个特定的值</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.just</span>(2, 3, 4)</div><div class="line">                <span class="selector-class">.contains</span>(2)</div><div class="line">                <span class="selector-class">.subscribe</span>((<span class="selector-tag">aBoolean</span>, <span class="selector-tag">throwable</span>) <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="selector-tag">aBoolean</span>));</div></pre></td></tr></table></figure>
</li>
<li><p>switchIfEmpty:如果原始Observable正常终止后仍然没有发射任何数据，就使用备用的Observable</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Observable.empty()</div><div class="line">        .switchIfEmpty(Observable.just(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>))</div><div class="line">        .subscribe(o -&gt; System.out.println(<span class="string">"===&gt;"</span> + o + <span class="string">"<span class="subst">\t</span>"</span>)); <span class="comment">//2,3,4</span></div></pre></td></tr></table></figure>
</li>
<li><p>defaultIfEmpty:发射来自原始Observable的值，如果原始Observable没有发射任何值，就发射一个默认值,内部调用的switchIfEmpty。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.empty</span>()</div><div class="line">           <span class="selector-class">.defaultIfEmpty</span>(<span class="number">1</span>)</div><div class="line">           <span class="selector-class">.subscribe</span>(o -&gt; System.out.println(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>)); <span class="comment">//1</span></div></pre></td></tr></table></figure>
</li>
<li><p>sequenceEqual:判定两个Observables是否发射相同的数据序列。（数据，发射顺序，终止状态）</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Observable.sequenceEqual(</div><div class="line">                Observable.just(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</div><div class="line">                , Observable.just(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>))</div><div class="line">                .subscribe((aBoolean, throwable) -&gt; System.out.println(aBoolean));</div><div class="line"></div><div class="line"></div><div class="line">&lt;!-- 它还有一个版本接受第三个参数，可以传递一个函数用于比较两个数据项是否相同。 --&gt;</div><div class="line">Observable.sequenceEqual(</div><div class="line">        Observable.just(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</div><div class="line">        , Observable.just(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</div><div class="line">        , (<span class="type">integer</span>, integer2) -&gt; <span class="type">integer</span> + <span class="number">1</span> == integer2)</div><div class="line">        .subscribe((aBoolean, throwable) -&gt; System.out.println(aBoolean));</div></pre></td></tr></table></figure>
</li>
<li><p>skipUntil:丢弃原始Observable发射的数据，直到第二个Observable发射了一项数据</p>
</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Observable.intervalRange(<span class="number">30</span>, <span class="number">20</span>, <span class="number">500</span>, <span class="number">100</span>, TimeUnit.MILLISECONDS)</div><div class="line">        .skipUntil(Observable.<span class="section">timer</span>(<span class="number">1000</span>, TimeUnit.MILLISECONDS))</div><div class="line">        .doOnNext(<span class="type">integer</span> -&gt; System.out.println(<span class="type">integer</span>))</div><div class="line">        <span class="comment">//此时用这个主要是 测试环境 有执行时间 所以用阻塞比较好</span></div><div class="line">        .blockingSubscribe();</div></pre></td></tr></table></figure>
<ul>
<li>skipWhile:丢弃Observable发射的数据，直到一个指定的条件不成立</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Observable.just(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</div><div class="line">               <span class="comment">//从2开始 因为2条件不成立</span></div><div class="line">               .skipWhile(aLong -&gt; aLong==<span class="number">1</span>)</div><div class="line">               .doOnNext(<span class="type">integer</span> -&gt; System.out.println(<span class="type">integer</span>))</div><div class="line">               <span class="comment">//此时用这个主要是 测试环境 有执行时间 所以用阻塞比较好</span></div><div class="line">               .blockingSubscribe();</div></pre></td></tr></table></figure>
<ul>
<li>takeUntil:当第二个Observable发射了一项数据或者终止时，丢弃原始Observable发射的任何数据</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 条件变体 --&gt;</span></div><div class="line">Observable.just(2,3,4,5)</div><div class="line">             .takeUntil(integer -&gt;  integer<span class="tag">&lt;<span class="name">=4)</span></span></div><div class="line">             <span class="attr">.subscribe</span>(<span class="attr">o</span> <span class="attr">-</span>&gt; System.out.print(o + "\t"));//2,3,4</div><div class="line"><span class="comment">&lt;!-- Observable变体 --&gt;</span></div><div class="line">Observable.intervalRange(30, 20, 500, 100, TimeUnit.MILLISECONDS)</div><div class="line">             .takeUntil(Observable.timer(1000, TimeUnit.MILLISECONDS))</div><div class="line">             .doOnNext(integer -&gt; System.out.println(integer))</div><div class="line">             .doOnComplete(() -&gt; System.out.println("Complete"))</div><div class="line">             //此时用这个主要是 测试环境 有执行时间 所以用阻塞比较好</div><div class="line">             .blockingSubscribe();</div></pre></td></tr></table></figure>
<ul>
<li>takeWhile:发射Observable发射的数据，直到一个指定的条件不成立</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Observable.just(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</div><div class="line">        .takeWhile(<span class="type">integer</span> -&gt;<span class="type">integer</span>&lt;=<span class="number">4</span> )</div><div class="line">        .subscribe(o -&gt; System.out.print(o + <span class="string">"<span class="subst">\t</span>"</span>));<span class="comment">//2,3</span></div></pre></td></tr></table></figure>
<h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><ul>
<li><p>onErrorReturn:让Observable遇到错误时发射一个特殊的项并且正常终止</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&lt;!-- 遇到错误处理范例<span class="function"> --&gt;</span></div><div class="line">Observable.error(<span class="keyword">new</span> Throwable(<span class="string">"我擦 空啊"</span>))</div><div class="line">            .onErrorReturnItem(<span class="string">"hei"</span>)</div><div class="line">            .subscribe(o<span class="function"> -&gt;</span> System.out.println(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>)</div><div class="line">                    , throwable<span class="function"> -&gt;</span> System.out.println(<span class="string">"===&gt;throwable"</span>)</div><div class="line">                    , <span class="function"><span class="params">()</span> -&gt;</span> System.out.println(<span class="string">"===&gt;complete"</span>));</div><div class="line">日志:</div><div class="line">===&gt;hei</div><div class="line">===&gt;complete</div><div class="line"></div><div class="line">&lt;!--  遇到错误不处理范例<span class="function"> --&gt;</span></div><div class="line">  Observable.error(<span class="keyword">new</span> Throwable(<span class="string">"我擦 空啊"</span>))</div><div class="line">                .onErrorReturn(throwable<span class="function"> -&gt;</span> &#123;</div><div class="line">                    System.out.println(<span class="string">"错误信息："</span> + throwable.getMessage());</div><div class="line">                    <span class="keyword">return</span> throwable;</div><div class="line">                &#125;)</div><div class="line">                .subscribe(o<span class="function"> -&gt;</span> System.out.println(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>)</div><div class="line">                        , throwable<span class="function"> -&gt;</span> System.out.println(<span class="string">"===&gt;throwable"</span>)</div><div class="line">                        , <span class="function"><span class="params">()</span> -&gt;</span> System.out.println(<span class="string">"===&gt;complete"</span>));</div><div class="line">日志:</div><div class="line">错误信息：我擦 空啊</div><div class="line">===&gt;java.lang.Throwable: 我擦 空啊</div><div class="line">===&gt;complete</div></pre></td></tr></table></figure>
</li>
<li><p>resumeNext:让Observable在遇到错误时开始发射第二个Observable的数据序列</p>
<ul>
<li><p>onErrorResumeNext:可以处理所有的错误</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Observable.error(<span class="keyword">new</span> Throwable(<span class="string">"我擦 空啊"</span>))</div><div class="line">              .onErrorResumeNext(throwable -&gt; &#123;</div><div class="line">                  System.out.println(<span class="string">"错误信息："</span> + throwable.getMessage());</div><div class="line">                  <span class="keyword">return</span> Observable.range(<span class="number">0</span>, <span class="number">3</span>);</div><div class="line">              &#125;)</div><div class="line">         .subscribe(o -&gt; System.out.<span class="built_in">print</span>(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>)</div><div class="line">                           , throwable -&gt; System.out.<span class="built_in">print</span>(<span class="string">"===&gt;throwable"</span>+ <span class="string">"\t"</span>)</div><div class="line">                           , <span class="function"><span class="params">()</span> -&gt;</span> System.out.<span class="built_in">print</span>(<span class="string">"===&gt;complete"</span>+ <span class="string">"\t"</span>));</div><div class="line">  日志：</div><div class="line">  错误信息：我擦 空啊</div><div class="line">  ==<span class="function">=&gt;</span><span class="number">0</span>	==<span class="function">=&gt;</span><span class="number">1</span>	==<span class="function">=&gt;</span><span class="number">2</span>	==<span class="function">=&gt;</span>complete</div></pre></td></tr></table></figure>
</li>
<li><p>onExceptionResumeNext:只能处理异常。</p>
<blockquote>
<p>Throwable 不是一个 Exception ,它会将错误传递给观察者的 onError 方法，不会使用备用 的Observable。</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- Throwable不能处理范例 --&gt;</span></div><div class="line">Observable.error(new Throwable("我擦 空啊"))</div><div class="line">              .onExceptionResumeNext(observer -&gt; Observable.range(0, 3))</div><div class="line">              .subscribe(o -&gt; System.out.println("===&gt;" + o + "\t")</div><div class="line">                      , throwable -&gt; System.out.println("===&gt;throwable")</div><div class="line">                      , () -&gt; System.out.println("===&gt;complete"));</div><div class="line">  日志:</div><div class="line">  ===&gt;throwable</div><div class="line">  <span class="comment">&lt;!-- 正确演示范例 无效ing 求解答~ todo --&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>retry:如果原始Observable遇到错误，重新订阅它期望它能正常终止</p>
<ul>
<li><p>变体count 重复次数</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Observable.create(e -&gt; &#123;</div><div class="line">     e.onNext(<span class="number">1</span>);</div><div class="line">     e.onNext(<span class="number">2</span>);</div><div class="line">     e.onError(<span class="keyword">new</span> Throwable(<span class="string">"hehe"</span>));</div><div class="line"> &#125;)</div><div class="line">         .retry(<span class="number">2</span>)</div><div class="line">         .subscribe(o -&gt; System.out.<span class="built_in">print</span>(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>)</div><div class="line">                 , throwable -&gt; System.out.<span class="built_in">print</span>(<span class="string">"===&gt;throwable\t"</span>)</div><div class="line">                 , <span class="function"><span class="params">()</span> -&gt;</span> System.out.<span class="built_in">print</span>(<span class="string">"===&gt;complete\t"</span>));</div><div class="line"> 日志:</div><div class="line"> ==<span class="function">=&gt;</span><span class="number">1</span>	==<span class="function">=&gt;</span><span class="number">2</span>	==<span class="function">=&gt;</span><span class="number">1</span>	==<span class="function">=&gt;</span><span class="number">2</span>	==<span class="function">=&gt;</span><span class="number">1</span>	==<span class="function">=&gt;</span><span class="number">2</span>	==<span class="function">=&gt;</span>throwable</div></pre></td></tr></table></figure>
</li>
<li><p>变体Predicate 条件判定 如果返回 true retry,false 放弃 retry</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Observable.create(e<span class="function"> -&gt;</span> &#123;</div><div class="line">     e.onNext(<span class="number">1</span>);</div><div class="line">     e.onNext(<span class="number">2</span>);</div><div class="line">     e.onError(<span class="keyword">new</span> Throwable(<span class="string">"hehe"</span>));</div><div class="line"> &#125;)</div><div class="line">         .retry(throwable<span class="function"> -&gt;</span> throwable.getMessage().equals(<span class="string">"hehe1"</span>))</div><div class="line">         .subscribe(o<span class="function"> -&gt;</span> System.out.<span class="built_in">print</span>(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>)</div><div class="line">                 , throwable<span class="function"> -&gt;</span> System.out.<span class="built_in">print</span>(<span class="string">"===&gt;throwable\t"</span>)</div><div class="line">                 , <span class="function"><span class="params">()</span> -&gt;</span> System.out.<span class="built_in">print</span>(<span class="string">"===&gt;complete\t"</span>));</div><div class="line"> 日志:</div><div class="line">===&gt;<span class="number">1</span>	===&gt;<span class="number">2</span>	===&gt;throwable</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>retryWhen: 需要一个Observable 通过判断 throwableObservable,Observable发射一个数据 就重新订阅，发射的是 onError 通知，它就将这个通知传递给观察者然后终止。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">&lt;!-- 正常范例 --&gt;</span></div><div class="line">  Observable.just(1, "2", 3)</div><div class="line">                .cast(Integer.class)</div><div class="line">                <span class="comment">&lt;!-- 结果：1,1,complete 原因这个Observable发了一次数据 --&gt;</span></div><div class="line">                .retryWhen(throwableObservable -&gt; Observable.timer(1, TimeUnit.SECONDS))</div><div class="line">                <span class="comment">&lt;!-- 结果：1,1,1,1,complete 原因这个Observable发了三次数据 --&gt;</span></div><div class="line">                .retryWhen(throwableObservable -&gt; Observable.interval(1, TimeUnit.SECONDS)</div><div class="line">                    .take(3))</div><div class="line">                .subscribe(o -&gt; System.out.println("retryWhen 1===&gt;" + o + "\t")</div><div class="line">                        , throwable -&gt; System.out.println("retryWhen 1===&gt;throwable")</div><div class="line">                        , () -&gt; System.out.println("retryWhen 1===&gt;complete"));</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- 通过判断throwable 进行处理范例 --&gt;</span></div><div class="line">    Observable.just(1, "2", 3)</div><div class="line">                .cast(Integer.class)</div><div class="line">                .retryWhen(throwableObservable -&gt; &#123;</div><div class="line">                    return throwableObservable.switchMap(throwable -&gt; &#123;</div><div class="line">                        if (throwable instanceof IllegalArgumentException)</div><div class="line">                            return Observable.just(throwable);</div><div class="line">                            <span class="comment">&lt;!-- 这种方式OK --&gt;</span></div><div class="line">//                        else&#123;</div><div class="line">//                            PublishSubject<span class="tag">&lt;<span class="name">Object</span>&gt;</span> pb = PublishSubject.create();</div><div class="line">//                            pb .onError(throwable);</div><div class="line">//                            return pb;</div><div class="line">//                        &#125;</div><div class="line">                        else</div><div class="line">                            //方法泛型</div><div class="line">                            return Observable.<span class="tag">&lt;<span class="name">Object</span>&gt;</span>error(throwable);</div><div class="line">                          <span class="comment">&lt;!-- 这种方式也OK --&gt;</span></div><div class="line">//                        return Observable.just(1).cast(String.class);</div><div class="line">                    &#125;);</div><div class="line">                &#125;)</div><div class="line">                .subscribe(o -&gt; System.out.println("retryWhen 2===&gt;" + o + "\t")</div><div class="line">                        , throwable -&gt; System.out.println("retryWhen 2===&gt;throwable")</div><div class="line">                        , () -&gt; System.out.println("retryWhen 2===&gt;complete"));</div><div class="line">日志:</div><div class="line">retryWhen 2===&gt;1</div><div class="line">retryWhen 2===&gt;throwable</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="阻塞操作"><a href="#阻塞操作" class="headerlink" title="阻塞操作"></a>阻塞操作</h2><ul>
<li><p>toList</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.just</span>(1, 2, 3)</div><div class="line">              <span class="selector-class">.toList</span>()<span class="selector-class">.blockingGet</span>()</div><div class="line">              <span class="selector-class">.forEach</span>(<span class="selector-tag">aLong</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="selector-tag">aLong</span>));</div></pre></td></tr></table></figure>
</li>
<li><p>toSortList</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.just</span>(5, 2, 3)</div><div class="line">           <span class="selector-class">.toSortedList</span>()</div><div class="line">           <span class="selector-class">.blockingGet</span>()</div><div class="line">           <span class="selector-class">.forEach</span>(<span class="selector-tag">integer</span> <span class="selector-tag">-</span>&gt; <span class="selector-tag">System</span><span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="selector-tag">integer</span>))</div></pre></td></tr></table></figure>
</li>
<li><p>toMap</p>
<figure class="highlight vhdl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">     <span class="keyword">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">Integer</span>&gt; <span class="keyword">map</span> = Observable.just(<span class="number">5</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">//                .toMap(<span class="built_in">integer</span> -&gt; <span class="built_in">integer</span> + <span class="string">"_"</span>)</div><div class="line">                //key 就是<span class="number">5_</span>,value就是<span class="number">5</span>+<span class="number">10</span>   mapSupplier <span class="keyword">map</span>提供者</div><div class="line">                .toMap(<span class="built_in">integer</span> -&gt; <span class="built_in">integer</span> + <span class="string">"_"</span></div><div class="line">                        , <span class="built_in">integer</span> -&gt; <span class="built_in">integer</span> + <span class="number">10</span></div><div class="line">                        , () -&gt; <span class="keyword">new</span> HashMap&lt;&gt;())</div><div class="line">                .blockingGet();</div></pre></td></tr></table></figure>
</li>
<li><p>toFuture</p>
<blockquote>
<p>这个操作符将Observable转换为一个返 回单个数据项的 Future   带有返回值的任务<br>如果原始Observable发射多个数据项， Future 会收到1个 IllegalArgumentException<br>如果原始Observable没有发射任何数据， Future 会收到一 个 NoSuchElementException<br>如果你想将发射多个数据项的Observable转换为 Future ,可以这样 用: myObservable.toList().toFuture()</p>
</blockquote>
</li>
</ul>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Observable.just<span class="comment">(1, 2, 3)</span></div><div class="line">                   .toList<span class="comment">()</span><span class="comment">//转换成Single&lt;List&lt;T&gt;&gt; 这样就变成一个数据了</span></div><div class="line">                   .toFuture<span class="comment">()</span></div><div class="line">                   .get<span class="comment">()</span></div><div class="line">                   .forEach<span class="comment">(integer -&gt; System.out.println(integer)</span>);</div></pre></td></tr></table></figure>
<ul>
<li><p>blockingSubscribe</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">              .blockingSubscribe(<span class="type">integer</span> -&gt; System.out.println(<span class="type">integer</span>));</div></pre></td></tr></table></figure>
</li>
<li><p>blockingForEach:对BlockingObservable发射的每一项数据调用一个方法，会阻塞直到Observable完成。</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.interval</span>(<span class="number">100</span>, TimeUnit.MILLISECONDS)</div><div class="line">        <span class="selector-class">.doOnNext</span>(aLong -&gt; &#123;</div><div class="line">            <span class="selector-tag">if</span> (aLong == <span class="number">10</span>)</div><div class="line">                <span class="selector-tag">throw</span> <span class="selector-tag">new</span> <span class="selector-tag">RuntimeException</span>();</div><div class="line">        &#125;)<span class="selector-class">.onErrorReturnItem</span>(-<span class="number">1</span>L)</div><div class="line">        <span class="selector-class">.blockingForEach</span>(aLong -&gt; System.out.println(aLong));</div></pre></td></tr></table></figure>
</li>
<li><p>blockingIterable</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">   <span class="selector-tag">Observable</span><span class="selector-class">.just</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">                <span class="selector-class">.blockingIterable</span>()</div><div class="line"><span class="comment">//                .blockingIterable(5);</span></div><div class="line">                <span class="selector-class">.forEach</span>(aLong -&gt; System.out.println(<span class="string">"aLong:"</span> + aLong));</div></pre></td></tr></table></figure>
</li>
<li><p>blockingFirst</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Observable</span><span class="selector-class">.empty</span>()</div><div class="line">   <span class="comment">// .blockingFirst();</span></div><div class="line">   <span class="comment">//带默认值版本</span></div><div class="line">    <span class="selector-class">.blockingFirst</span>(-<span class="number">1</span>));</div></pre></td></tr></table></figure>
</li>
<li><p>blockingLast：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Observable.just(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</div><div class="line">      <span class="comment">// .blockingLast();</span></div><div class="line">      <span class="comment">//带默认值版本</span></div><div class="line">       .blockingLast(<span class="number">-1</span>));</div></pre></td></tr></table></figure>
</li>
<li><p>blockingMostRecent:返回一个总是返回Observable最近发射的数据的Iterable,类似于while的感觉</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"> Iterable&lt;<span class="keyword">Long</span>&gt; c = Observable.interval(<span class="number">100</span>, TimeUnit.MILLISECONDS)</div><div class="line">            .doOnNext(aLong -&gt; &#123;</div><div class="line">                <span class="keyword">if</span> (aLong == <span class="number">10</span>)</div><div class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException();</div><div class="line">            &#125;).onErrorReturnItem(-<span class="number">1</span>L)</div><div class="line">            .blockingMostRecent(-<span class="number">3</span>L);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">Long</span> aLong : c) &#123;</div><div class="line">            System.out.<span class="keyword">println</span>(<span class="string">"aLong:"</span> + aLong);</div><div class="line">        &#125;</div><div class="line">日志很长 可以自己一试变知</div></pre></td></tr></table></figure>
</li>
<li><p>blockingSingle:</p>
</li>
</ul>
<blockquote>
<p>终止时只发射了一个值，返回那个值<br> empty   无默认值 报错， 默认值的话显示默认值<br>多个值的话  有无默认值都报错</p>
</blockquote>
<figure class="highlight golo"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">System.out.<span class="keyword">println</span>(<span class="string">"emit 1 value:"</span> + <span class="keyword">Observable</span>.just(<span class="number">1</span>).blockingSingle());</div><div class="line">System.out.<span class="keyword">println</span>(<span class="string">"default empty single:"</span> + <span class="keyword">Observable</span>.empty().blockingSingle(<span class="number">-1</span>));</div><div class="line">System.out.<span class="keyword">println</span>(<span class="string">"default emit 1 value:"</span> + <span class="keyword">Observable</span>.just(<span class="number">1</span>).blockingSingle(<span class="number">-1</span>));</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">    System.out.<span class="keyword">println</span>(<span class="string">"empty single:"</span> + <span class="keyword">Observable</span>.empty().blockingSingle());</div><div class="line">    System.out.<span class="keyword">println</span>(<span class="string">"emit many value:"</span> + <span class="keyword">Observable</span>.just(<span class="number">1</span>, <span class="number">2</span>).blockingSingle());</div><div class="line">    System.out.<span class="keyword">println</span>(<span class="string">"default emit many value:"</span> + <span class="keyword">Observable</span>.just(<span class="number">1</span>, <span class="number">2</span>)</div><div class="line">            .blockingSingle(<span class="number">-1</span>));</div><div class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">    e.printStackTrace();</div><div class="line">&#125;</div><div class="line">日志:</div><div class="line">emit <span class="number">1</span> value:<span class="number">1</span></div><div class="line">default empty single:<span class="number">-1</span></div><div class="line">default emit <span class="number">1</span> value:<span class="number">1</span></div><div class="line">java.util.NoSuchElementException</div></pre></td></tr></table></figure>
<h2 id="组合操作"><a href="#组合操作" class="headerlink" title="组合操作"></a>组合操作</h2><ul>
<li>compose:有多个 Observable ，并且他们都需要应用<code>一组相同的 变换</code></li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!--  用一个工具类去写 这样符合单一职责 --&gt;</span></div><div class="line">//composes 工具类</div><div class="line">public class RxComposes &#123;</div><div class="line"></div><div class="line">    public static <span class="tag">&lt;<span class="name">T</span>&gt;</span> ObservableTransformer<span class="tag">&lt;<span class="name">T,</span> <span class="attr">T</span>&gt;</span> applyObservableAsync() &#123;</div><div class="line">        return upstream -&gt; upstream.subscribeOn(Schedulers.io())</div><div class="line">                .observeOn(AndroidSchedulers.mainThread());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">  Observable.empty()</div><div class="line">                .compose(RxComposes.applyObservableAsync())</div><div class="line">                .subscribe(integer -&gt; System.out.println("ob3:" + integer));</div></pre></td></tr></table></figure>
<ul>
<li><p>ConnectableObservable：可连接的Observable在 被订阅时并不开始发射数据，只有在它的 connect() 被调用时才开始用这种方法，<br>你可以 等所有的潜在订阅者都订阅了这个Observable之后才开始发射数据。即使没有任何订阅者订阅它，你也可以使用 connect 让他发射</p>
<ul>
<li><p>replay(Observable的方法): 每次订阅 都对单个订阅的重复播放一边</p>
<ul>
<li>bufferSize:对源发射队列的缓存数量, 从而对新订阅的进行发射；</li>
</ul>
<blockquote>
<p>Observable的方法 返回是ConnectableObservable<br>切记要让ConnectableObservable具有重播的能力,必须Obserable的时候调用replay,而不是ConnectableObservable 的时候调用replay</p>
</blockquote>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//this  is  OK,too!</span></div><div class="line">     ConnectableObservable&lt;Integer&gt; co = Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">             <span class="comment">//类似 publish直接转成 ConnectableObservable  切记要重复播放的话必须Obserable的时候调用replay</span></div><div class="line">             <span class="comment">//而不是ConnectableObservable 的时候调用replay 所以 .publish().replay()则无效</span></div><div class="line">             .replay(<span class="number">3</span>);<span class="comment">//重复播放的 是1  2  3</span></div><div class="line"><span class="comment">//           .replay(2);//重复播放的 是 2  3</span></div><div class="line"></div><div class="line">     co.doOnSubscribe(disposable -&gt; System.out.print(<span class="string">"订阅1："</span>))</div><div class="line">             .doFinally(() -&gt; System.out.println())</div><div class="line">             .subscribe(<span class="type">integer</span> -&gt; System.out.print(<span class="type">integer</span> + <span class="string">"<span class="subst">\t</span>"</span>));</div><div class="line">     co.connect();<span class="comment">//此时开始发射数据 不同与 refCount 只发送一次</span></div><div class="line"></div><div class="line">     co.doOnSubscribe(disposable -&gt; System.out.print(<span class="string">"订阅2："</span>))</div><div class="line">             .doFinally(() -&gt; System.out.println())</div><div class="line">             .subscribe(<span class="type">integer</span> -&gt; System.out.print(<span class="type">integer</span> + <span class="string">"<span class="subst">\t</span>"</span>));</div><div class="line"></div><div class="line">     co.doOnSubscribe(disposable -&gt; System.out.print(<span class="string">"订阅3："</span>))</div><div class="line">             .doFinally(() -&gt; System.out.println())</div><div class="line">             .subscribe(<span class="type">integer</span> -&gt; System.out.print(<span class="type">integer</span> + <span class="string">"<span class="subst">\t</span>"</span>));</div><div class="line"></div><div class="line">replay(<span class="number">3</span>)日志：只能缓存原始队列的两个【<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>】</div><div class="line">订阅<span class="number">1</span>：<span class="number">1</span>	<span class="number">2</span>	<span class="number">3</span></div><div class="line">订阅<span class="number">2</span>：<span class="number">1</span>	<span class="number">2</span>	<span class="number">3</span></div><div class="line">订阅<span class="number">3</span>：<span class="number">1</span>	<span class="number">2</span>	<span class="number">3</span></div><div class="line"></div><div class="line">replay(<span class="number">2</span>)日志：只能缓存原始队列的两个【<span class="number">2</span>,<span class="number">3</span>】</div><div class="line">订阅<span class="number">1</span>：<span class="number">1</span>	<span class="number">2</span>	<span class="number">3</span></div><div class="line">订阅<span class="number">2</span>：	<span class="number">2</span>	<span class="number">3</span></div><div class="line">订阅<span class="number">3</span>：	<span class="number">2</span>	<span class="number">3</span></div></pre></td></tr></table></figure>
</li>
<li><p>publish(Observable的方法):将普通的Observable转换为可连接的Observable</p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">ConnectableObservable&lt;Integer&gt; co = Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">               .publish();</div><div class="line"></div><div class="line">       <span class="function"><span class="title">co</span>.subscribe(<span class="keyword">integer</span> -&gt;</span> System.out.println(<span class="string">"订阅1："</span> + <span class="keyword">integer</span>));</div><div class="line">       <span class="function"><span class="title">co</span>.subscribe(<span class="keyword">integer</span> -&gt;</span> System.out.println(<span class="string">"订阅2："</span> + <span class="keyword">integer</span>));</div><div class="line">       <span class="function"><span class="title">co</span>.subscribe(<span class="keyword">integer</span> -&gt;</span> System.out.println(<span class="string">"订阅3："</span> + <span class="keyword">integer</span>));</div><div class="line">       co.connect();<span class="comment">//此时开始发射数据</span></div></pre></td></tr></table></figure>
<ul>
<li>refCount(ConnectableObservable的方法): 操作符把从一个可连接的Observable连接和断开的过程自动化了, 就像reply的感觉式样 每次订阅 都对单个订阅的重复播放一边<figure class="highlight xl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"> Observable&lt;Integer&gt; co = Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line">                .publish()</div><div class="line">                <span class="comment">//类似于reply  跟时间线有关  订阅开始就开始发送</span></div><div class="line">                .refCount();</div><div class="line"></div><div class="line">        <span class="function"><span class="title">co</span>.doOnSubscribe(disposable -&gt;</span> System.out.print(<span class="string">"订阅1："</span>))</div><div class="line">                .<span class="function"><span class="title">doFinally</span>(() -&gt;</span> System.out.println())</div><div class="line">                .<span class="function"><span class="title">subscribe</span>(<span class="keyword">integer</span> -&gt;</span> System.out.print(<span class="keyword">integer</span> + <span class="string">"\t"</span>));</div><div class="line">        <span class="function"><span class="title">co</span>.doOnSubscribe(disposable -&gt;</span> System.out.print(<span class="string">"订阅2："</span>))</div><div class="line">                .<span class="function"><span class="title">doFinally</span>(() -&gt;</span> System.out.println())</div><div class="line">                .<span class="function"><span class="title">subscribe</span>(<span class="keyword">integer</span> -&gt;</span> System.out.print(<span class="keyword">integer</span> + <span class="string">"\t"</span>));</div><div class="line"></div><div class="line">        Observable.timer(<span class="number">300</span>, TimeUnit.MILLISECONDS)</div><div class="line">                .<span class="function"><span class="title">doOnComplete</span>(() -&gt;</span> &#123;</div><div class="line">                    <span class="function"><span class="title">co</span>.doOnSubscribe(disposable -&gt;</span> System.out.print(<span class="string">"订阅3："</span>))</div><div class="line">                            .<span class="function"><span class="title">doFinally</span>(() -&gt;</span> System.out.println())</div><div class="line">                            .<span class="function"><span class="title">subscribe</span>(<span class="keyword">integer</span> -&gt;</span> System.out.print(<span class="keyword">integer</span> + <span class="string">"\t"</span>));</div><div class="line">                &#125;).blockingSubscribe();</div><div class="line">日志:</div><div class="line">订阅<span class="number">1</span>：<span class="number">1</span>	<span class="number">2</span>	<span class="number">3</span></div><div class="line">订阅<span class="number">2</span>：<span class="number">1</span>	<span class="number">2</span>	<span class="number">3</span></div><div class="line">订阅<span class="number">3</span>：<span class="number">1</span>	<span class="number">2</span>	<span class="number">3</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Subjects"><a href="#Subjects" class="headerlink" title="Subjects"></a>Subjects</h2><p>Subject可以看成是一个桥梁或者代理，在某些ReactiveX实现中(如RxJava)，它同时充当 了Observer和Observable的角色。因为它是一个Observer，它可以订阅一个或多个 Observable;又因为它是一个Observable，它可以转发它收到(Observe)的数据，也可以发射 新的数据。</p>
<blockquote>
<p>对我来说为什么用subjects呢？所有Subject都可以直接发射,不需要 发射器的引用 和 Observable.create()不同</p>
</blockquote>
<ul>
<li>AsyncSubject:简单的说使用AsyncSubject无论输入多少参数，永远只输出最后一个参数。<blockquote>
<p>但是如果因为发生了错误而终止，AsyncSubject将不会发射任何数据，只是简单的向前传递这个错误通知。</p>
</blockquote>
</li>
</ul>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">AsyncSubject&lt;Integer&gt; <span class="keyword">source</span> = AsyncSubject.create();</div><div class="line"></div><div class="line">    <span class="keyword">source</span>.subscribe(o -&gt; System.out.<span class="keyword">println</span>(<span class="string">"1:"</span>+o)); <span class="comment">// it will emit only 4 and onComplete</span></div><div class="line"></div><div class="line">    <span class="keyword">source</span>.onNext(<span class="number">1</span>);</div><div class="line">    <span class="keyword">source</span>.onNext(<span class="number">2</span>);</div><div class="line">    <span class="keyword">source</span>.onNext(<span class="number">3</span>);</div><div class="line"></div><div class="line">     &lt;!-- it will emit <span class="number">4</span> and onComplete <span class="keyword">for</span> second observer also. --&gt;</div><div class="line">    <span class="keyword">source</span>.subscribe(o -&gt; System.out.<span class="keyword">println</span>(<span class="string">"2:"</span>+o));</div><div class="line"></div><div class="line">    <span class="keyword">source</span>.onNext(<span class="number">4</span>);</div><div class="line">    <span class="keyword">source</span>.onComplete();</div><div class="line">    日志:</div><div class="line">    <span class="number">1</span>:<span class="number">4</span></div><div class="line">    <span class="number">2</span>:<span class="number">4</span></div></pre></td></tr></table></figure>
<ul>
<li>BehaviorSubject:会发送离订阅最近的上一个值，没有上一个值的时候会发送默认值。</li>
</ul>
<blockquote>
<p>如果原始的Observable因为发生了一个错误而终止，BehaviorSubject将不会发射任何 数据，只是简单的向前传递这个错误通知。</p>
</blockquote>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"> BehaviorSubject&lt;Integer&gt; <span class="keyword">source</span> = BehaviorSubject.create();</div><div class="line">        <span class="comment">//默认值版本</span></div><div class="line"><span class="comment">//        BehaviorSubject&lt;Integer&gt; source = BehaviorSubject.createDefault(-1);</span></div><div class="line"></div><div class="line">        <span class="keyword">source</span>.subscribe(o -&gt; System.out.<span class="keyword">println</span>(<span class="string">"1:"</span>+o)); <span class="comment">// it will get 1, 2, 3, 4 and onComplete</span></div><div class="line"></div><div class="line">        <span class="keyword">source</span>.onNext(<span class="number">1</span>);</div><div class="line">        <span class="keyword">source</span>.onNext(<span class="number">2</span>);</div><div class="line">        <span class="keyword">source</span>.onNext(<span class="number">3</span>);</div><div class="line"></div><div class="line">        &lt;!-- it will emit <span class="number">3</span>(last emitted), <span class="number">4</span> and onComplete <span class="keyword">for</span> second observer also. --&gt;</div><div class="line">        <span class="keyword">source</span>.subscribe(o -&gt; System.out.<span class="keyword">println</span>(<span class="string">"2:"</span>+o));</div><div class="line"></div><div class="line">        <span class="keyword">source</span>.onNext(<span class="number">4</span>);</div><div class="line">        <span class="keyword">source</span>.onComplete();</div><div class="line">        日志:</div><div class="line">        <span class="number">1</span>:<span class="number">1</span></div><div class="line">        <span class="number">1</span>:<span class="number">2</span></div><div class="line">        <span class="number">1</span>:<span class="number">3</span></div><div class="line">        <span class="number">2</span>:<span class="number">3</span></div><div class="line">        <span class="number">1</span>:<span class="number">4</span></div><div class="line">        <span class="number">2</span>:<span class="number">4</span></div></pre></td></tr></table></figure>
<ul>
<li><code>publishSubject</code>(subject里最常用的):可以说是最正常的Subject，从那里订阅就从那里开始发送数据。<blockquote>
<p>如果原始的Observable因为发生了一个错误而终止，PublishSubject将不会发射任何数据，只 是简单的向前传递这个错误通知。</p>
</blockquote>
</li>
</ul>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">PublishSubject <span class="keyword">bs </span>= PublishSubject.create()<span class="comment">;</span></div><div class="line"></div><div class="line">        <span class="keyword">bs.subscribe(o </span>-&gt; System.out.println(<span class="string">"1:"</span>+o))<span class="comment">;</span></div><div class="line">        <span class="keyword">bs.onNext(1);</span></div><div class="line">        <span class="keyword">bs.onNext(2);</span></div><div class="line">        <span class="keyword">bs.subscribe(o </span>-&gt; System.out.println(<span class="string">"2:"</span>+o))<span class="comment">;</span></div><div class="line">        <span class="keyword">bs.onNext(3);</span></div><div class="line">        <span class="keyword">bs.onComplete();</span></div><div class="line">        <span class="keyword">bs.subscribe(o </span>-&gt; System.out.println(<span class="string">"3:"</span>+o))<span class="comment">;</span></div><div class="line">        日志：</div><div class="line"><span class="symbol">        1:</span><span class="number">1</span></div><div class="line"><span class="symbol">        1:</span><span class="number">2</span></div><div class="line"><span class="symbol">        1:</span><span class="number">3</span></div><div class="line"><span class="symbol">        2:</span><span class="number">3</span></div></pre></td></tr></table></figure>
<ul>
<li>replaySubject: 无论何时订阅，都会将所有历史订阅内容全部发出。</li>
</ul>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">        ReplaySubject <span class="keyword">bs</span> = ReplaySubject.create();</div><div class="line"></div><div class="line">        <span class="keyword">bs</span>.subscribe(o -&gt; System.<span class="keyword">out</span>.println(<span class="string">"1:"</span>+o));</div><div class="line"><span class="comment">// 无论何时订阅都会收到1，2，3</span></div><div class="line">        <span class="keyword">bs</span>.onNext(1);</div><div class="line">        <span class="keyword">bs</span>.onNext(2);</div><div class="line">        <span class="keyword">bs</span>.onNext(3);</div><div class="line">        <span class="keyword">bs</span>.onComplete();</div><div class="line"></div><div class="line">        <span class="keyword">bs</span>.subscribe(o -&gt; System.<span class="keyword">out</span>.println(<span class="string">"2:"</span>+o));</div><div class="line">        日志:</div><div class="line">        1:1</div><div class="line">        1:2</div><div class="line">        1:3</div><div class="line">        2:1</div><div class="line">        2:2</div><div class="line">        2:3</div></pre></td></tr></table></figure>
<h2 id="Single与Completable"><a href="#Single与Completable" class="headerlink" title="Single与Completable"></a>Single与Completable</h2><p>参考:<a href="http://developer.51cto.com/art/201703/535298.htm" target="_blank" rel="external">http://developer.51cto.com/art/201703/535298.htm</a></p>
<p>使用场景:其实这个网络请求并不是一个连续事件流，你只会发起一次 Get 请求返回数据并且只收到一个事件。我们都知道这种情况下 onComplete 会紧跟着 onNext 被调用，那为什么不把它们合二为一呢？</p>
<ul>
<li>Single:它总是只发射一个值，或者一个错误通知，而不是发射 一系列的值。因此，不同于Observable需要三个方法onNext, onError, onCompleted，订阅Single只需要两 个方法:</li>
</ul>
<blockquote>
<p>Single只会调用这两个方法中的一个，而且只会调用一次，调用了任何一个方法之后，订阅关 系终止。</p>
</blockquote>
<pre><code>* onSuccess - Single发射单个的值到这个方法
* onError - 如果无法发射需要的值，Single发射一个Throwable对象到这个方法
</code></pre><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!--  retrofit 范例--&gt;</span></div><div class="line"> public interface APIClient &#123;</div><div class="line"></div><div class="line">     @GET("my/api/path")</div><div class="line">     Single<span class="tag">&lt;<span class="name">MyData</span>&gt;</span> getMyData();</div><div class="line"> &#125;</div><div class="line"></div><div class="line"></div><div class="line"> apiClient.getMyData()</div><div class="line">     .subscribe(new Consumer<span class="tag">&lt;<span class="name">MyData</span>&gt;</span>() &#123;</div><div class="line">         @Override</div><div class="line">         public void accept(MyData myData) throws Exception &#123;</div><div class="line">             // handle data fetched successfully and API call completed</div><div class="line">         &#125;</div><div class="line">     &#125;, new Consumer<span class="tag">&lt;<span class="name">Throwable</span>&gt;</span>() &#123;</div><div class="line">         @Override</div><div class="line">         public void accept(Throwable throwable) throws Exception&#123;</div><div class="line">             // handle error event</div><div class="line">         &#125;</div><div class="line">     &#125;);</div><div class="line"></div><div class="line"></div><div class="line">     <span class="comment">&lt;!-- 单独使用范例： --&gt;</span></div><div class="line">        Single.just("Amit")</div><div class="line">            .subscribe(s -&gt; System.out.println(s)</div><div class="line">                    , throwable -&gt; System.out.println("异常"));</div></pre></td></tr></table></figure>
<p>使用场景:通过 PUT 请求更新数据 我只关心 onComplete 事件。使用 Completable 时我们忽略 onNext 事件，只处理 onComplete 和 onError 事件</p>
<ul>
<li>Completable:本质上来说和 Observable 与 Single 不一样，因为它不发射数据。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">&lt;!--  retrofit 范例--&gt;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">APIClient</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@PUT</span>(<span class="string">"my/api/updatepath"</span>)</div><div class="line">    <span class="function">Completable <span class="title">updateMyData</span><span class="params">(@Body MyData data)</span></span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">apiClient.updateMyData(myUpdatedData)</div><div class="line">    .subscribe(<span class="keyword">new</span> Action() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">            <span class="comment">// handle completion</span></div><div class="line">        &#125;</div><div class="line">    &#125;, <span class="keyword">new</span> Consumer&lt;Throwable&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Throwable throwable)</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">            <span class="comment">// handle error</span></div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line"></div><div class="line">    &lt;!-- 单独使用范例： --&gt;</div><div class="line">     Completable.timer(<span class="number">1000</span>, TimeUnit.MILLISECONDS)</div><div class="line">                    .subscribe(() -&gt; System.out.println(<span class="string">"成功"</span>)</div><div class="line">                            , throwable -&gt; System.out.println(<span class="string">"异常"</span>));</div></pre></td></tr></table></figure>
<ul>
<li><p>andThen( Completable中的方法最常用):在这个操作符中你可以传任何Observable、Single、Flowable、Maybe或者其他Completable，它们会在原来的 Completable 结束后执行</p>
  <figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">apiClient.updateMyData(myUpdatedData)</div><div class="line">    .andThen(performOtherOperation()) <span class="comment">// a Single&lt;OtherResult&gt;</span></div><div class="line">    .subscribe(<span class="keyword">new</span> Consumer&lt;OtherResult&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">accept</span><span class="params">(OtherResult result)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">            <span class="comment">// handle otherResult</span></div><div class="line">        &#125;</div><div class="line">    &#125;, <span class="keyword">new</span> Consumer&lt;Throwable&gt;() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">accept</span><span class="params">(Throwable throwable)</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">            <span class="comment">// handle error</span></div><div class="line">        &#125;</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="自定义操作符"><a href="#自定义操作符" class="headerlink" title="自定义操作符"></a>自定义操作符</h2><ul>
<li>lift 原理图</li>
</ul>
<p><img src="https://ww4.sinaimg.cn/large/006tKfTcgy1fi33z4i9jlj30mi0gp74i.jpg" alt=""></p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="variable">@Test</span></div><div class="line">    public void lift()&#123;</div><div class="line">            <span class="selector-tag">Observable</span><span class="selector-class">.just</span>(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">                    <span class="comment">//也是代理模式  observer是真正订阅</span></div><div class="line">                    <span class="selector-class">.lift</span>(observer -&gt; new Observer&lt;Integer&gt;() &#123;</div><div class="line">                        <span class="variable">@Override</span></div><div class="line">                        public void onSubscribe(Disposable d) &#123;</div><div class="line"></div><div class="line">                        &#125;</div><div class="line"></div><div class="line">                        <span class="variable">@Override</span></div><div class="line">                        public void onNext(Integer integer) &#123;</div><div class="line">                            <span class="selector-tag">observer</span><span class="selector-class">.onNext</span>(integer+<span class="string">"?"</span>);</div><div class="line">                        &#125;</div><div class="line"></div><div class="line">                        @<span class="selector-tag">Override</span></div><div class="line">                        <span class="selector-tag">public</span> <span class="selector-tag">void</span> <span class="selector-tag">onError</span>(Throwable e) &#123;</div><div class="line"></div><div class="line">                        &#125;</div><div class="line"></div><div class="line">                        <span class="variable">@Override</span></div><div class="line">                        public void onComplete() &#123;</div><div class="line"></div><div class="line">                        &#125;</div><div class="line">                    &#125;)</div><div class="line">                    <span class="selector-class">.subscribe</span>(o -&gt; System.out.println(o));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    日志:</div><div class="line">    <span class="selector-tag">1</span>?</div><div class="line">    <span class="selector-tag">2</span>?</div></pre></td></tr></table></figure>
<h2 id="实用技巧"><a href="#实用技巧" class="headerlink" title="实用技巧"></a>实用技巧</h2><p>flatMap 与 zip 配合的实用范例:</p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">Observable.fromArray(new File(<span class="string">"/Users/fuzhipeng/Documents"</span>))</div><div class="line">               .<span class="function"><span class="title">flatMap</span>(file -&gt;</span> Observable.fromArray(file.listFiles()))</div><div class="line">               <span class="comment">//比较经典的 就是Observable.just(file) 把 file一个元素转成 observer从而进行zip合并的难题解决了</span></div><div class="line">               .<span class="function"><span class="title">flatMap</span>(file -&gt;</span></div><div class="line">                       Observable.zip(Observable.just(file)</div><div class="line">                               , Observable.timer(<span class="number">1</span>, TimeUnit.SECONDS)</div><div class="line">                               , (<span class="function"><span class="title">file1</span>, aLong) -&gt;</span> file1))</div><div class="line">               .<span class="function"><span class="title">filter</span>(file -&gt;</span> file.getName().endsWith(<span class="string">".png"</span>))</div><div class="line">               .take(<span class="number">5</span>)</div><div class="line">               .<span class="function"><span class="title">map</span>(file -&gt;</span> file.getName())</div><div class="line">               .subscribeOn(Schedulers.io())</div><div class="line">               .observeOn(Schedulers.newThread())</div><div class="line">               .<span class="function"><span class="title">subscribe</span>(s -&gt;</span> System.out.println(s));</div><div class="line">       <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">       &#125;</div></pre></td></tr></table></figure>
<p>map的实用范例:</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//有些服务几口设计，返回数据外层会包裹一些额外信息,可以使用map()吧外层格式剥掉</span></div><div class="line">       Observable.just(<span class="number">1</span>)</div><div class="line">               .map(<span class="type">integer</span> -&gt; new Integer[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;)</div><div class="line">               .subscribe(integers -&gt; System.out.println(integers));</div></pre></td></tr></table></figure>
<p>方法泛型的实用范例:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">Observable.just(<span class="number">1</span>, <span class="string">"2"</span>, <span class="number">3</span>)</div><div class="line">                .cast(Integer.<span class="keyword">class</span>)</div><div class="line">                .retryWhen(throwableObservable -&gt; &#123;</div><div class="line">                    <span class="keyword">return</span> throwableObservable.switchMap(throwable -&gt; &#123;</div><div class="line">                        <span class="keyword">if</span> (throwable instanceof IllegalArgumentException)</div><div class="line">                            <span class="keyword">return</span> Observable.just(throwable);</div><div class="line">                        <span class="comment">//todo  方法泛型 如果我不写&lt;Object&gt; 则会报错</span></div><div class="line">                        <span class="keyword">return</span> Observable.&lt;Object&gt;error(throwable);</div><div class="line">                        <span class="comment">//这个报错！！！</span></div><div class="line"><span class="comment">//                        return Observable.error(throwable);</span></div><div class="line">                    &#125;);</div><div class="line">                &#125;)</div><div class="line">                .subscribe(o -&gt; System.<span class="keyword">out</span>.println(<span class="string">"===&gt;"</span> + o + <span class="string">"\t"</span>)</div><div class="line">                        , throwable -&gt; System.<span class="keyword">out</span>.println(<span class="string">"===&gt;throwable"</span>)</div><div class="line">                        , () -&gt; System.<span class="keyword">out</span>.println(<span class="string">"===&gt;complete"</span>));</div></pre></td></tr></table></figure>
<p>BehaviorSubject的使用技巧:</p>
<blockquote>
<p>cache BehaviorSubject 是桥梁 并且有 发送最近的缓存特性！</p>
</blockquote>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">BehaviorSubject&lt;Object&gt; cache = BehaviorSubject.create();</div><div class="line">        Observable.timer(<span class="number">1</span>,TimeUnit.SECONDS)</div><div class="line">                .subscribeOn(Schedulers.<span class="keyword">new</span><span class="type">Thread</span>())</div><div class="line">                .observeOn(Schedulers.<span class="keyword">new</span><span class="type">Thread</span>())</div><div class="line">                .subscribe(cache);</div><div class="line"></div><div class="line">        <span class="comment">//可以想象成上面是方法  这里是方法被调用</span></div><div class="line">        cache.subscribe(o -&gt; System.out.println(o));<span class="comment">//结果0</span></div></pre></td></tr></table></figure>
<p>Observable 发射元素的封装范例:</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//创建一个Observable 可以直接发送的 原因 获取rx内部方法需要final很恶心 所以...</span></div><div class="line">        RxEmitter&lt;Integer&gt; emitter = <span class="keyword">new</span> RxEmitter();</div><div class="line">        Observable.create(emitter)</div><div class="line">                .subscribe(integer -&gt; System.out.println(integer));</div><div class="line">        emitter.onNext(<span class="number">1</span>);</div><div class="line">        emitter.onNext(<span class="number">2</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RxEmitter</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">ObservableOnSubscribe</span>&lt;<span class="title">T</span>&gt;, <span class="title">ObservableEmitter</span>&lt;<span class="title">T</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    ObservableEmitter&lt;T&gt; e;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">subscribe</span><span class="params">(ObservableEmitter&lt;T&gt; e)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        <span class="keyword">this</span>.e = e;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onNext</span><span class="params">(T value)</span> </span>&#123;</div><div class="line">        e.onNext(value);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable <span class="keyword">error</span>)</span> </span>&#123;</div><div class="line">        e.onError(<span class="keyword">error</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onComplete</span><span class="params">()</span> </span>&#123;</div><div class="line">        e.onComplete();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setDisposable</span><span class="params">(Disposable d)</span> </span>&#123;</div><div class="line">        e.setDisposable(d);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setCancellable</span><span class="params">(Cancellable c)</span> </span>&#123;</div><div class="line">        e.setCancellable(c);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">isDisposed</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="function"><span class="keyword">return</span> e.<span class="title">isDisposed</span><span class="params">()</span></span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> ObservableEmitter&lt;T&gt; serialize() &#123;</div><div class="line">        <span class="function"><span class="keyword">return</span> e.<span class="title">serialize</span><span class="params">()</span></span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">tryOnError</span><span class="params">(Throwable t)</span> </span>&#123;</div><div class="line">        <span class="function"><span class="keyword">return</span> e.<span class="title">tryOnError</span><span class="params">(t)</span></span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Reference-amp-Thanks："><a href="#Reference-amp-Thanks：" class="headerlink" title="Reference&amp;Thanks："></a>Reference&amp;Thanks：</h2><p><a href="https://www.gitbook.com/book/mcxiaoke/rxdocs/details" target="_blank" rel="external">https://www.gitbook.com/book/mcxiaoke/rxdocs/details</a></p>
<blockquote>
<p>基本上所有的都参考此文档 很神！</p>
</blockquote>
<p><a href="http://blog.csdn.net/maplejaw_/article/details/52396175" target="_blank" rel="external">http://blog.csdn.net/maplejaw_/article/details/52396175</a></p>
<p><a href="http://developer.51cto.com/art/201703/535298.htm" target="_blank" rel="external">http://developer.51cto.com/art/201703/535298.htm</a></p>
<p><a href="http://gank.io/post/560e15be2dca930e00da1083" target="_blank" rel="external">http://gank.io/post/560e15be2dca930e00da1083</a></p>
<p><a href="https://github.com/amitshekhariitbhu/RxJava2-Android-Samples" target="_blank" rel="external">https://github.com/amitshekhariitbhu/RxJava2-Android-Samples</a></p>
<p><a href="http://www.jianshu.com/u/c50b715ccaeb" target="_blank" rel="external">http://www.jianshu.com/u/c50b715ccaeb</a></p>

      
    </div>

    
  </article>


          </div>
          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2017/07/31/rxjava/"
           data-title="Rxjava2总结" data-url="https://luhaoaimama1.github.io/2017/07/31/rxjava/">
      </div>
    
  </div>

        </div>  
      </main>

      <footer id="footer" class="footer">
  <div class="social-links">
    
      
        
          <a href="mailto:1149324777@email.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
        
          <a href="https://github.com/luhaoaimama1" class="iconfont icon-github" title="github"></a>
        
      
    
      
        
          <a href="http://weibo.com/u/2193119237" class="iconfont icon-weibo" title="weibo"></a>
        
      
    
      
        
          <a href="https://juejin.im/user/5880867f8d6d810058b1c0a1" class="iconfont icon-coding" title="coding"></a>
        
      
    
      
    
    
    
  </div>


<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2015 - 
    
    2018

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Zone</span>
  </span>
</div>
      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"luhaoaimama1"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>



    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  

    <script type="text/javascript" src="/js/src/even.js?v=2.1.0"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.1.0"></script>

  </body>
</html>